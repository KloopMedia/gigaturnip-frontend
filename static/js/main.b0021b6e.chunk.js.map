{"version":3,"sources":["services/firebase/Firebase.js","context/authentication/AuthProvider.tsx","context/authentication/hooks/useAuth.tsx","utils/constants/Paths.js","pages/login/RequireAuth.tsx","services/api/Urls.js","context/toast/ToastProvider.tsx","context/toast/hooks/useToast.tsx","services/api/useAxios.tsx","components/card/Card.tsx","components/card/ExpandableCard.tsx","components/list/ListContent.tsx","components/list/ListHeader.tsx","components/list/List.tsx","pages/campaigns/Campaigns.tsx","pages/login/Login.tsx","components/layout/appbar/Appbar.tsx","components/layout/Layout.tsx","pages/chains/Chains.tsx","pages/graph/nodes/BaseNode.tsx","pages/graph/nodes/LogicNode.tsx","pages/graph/nodes/StageNode.tsx","utils/hooks/UseHelpers.ts","pages/graph/sidebar/Sidebar.tsx","pages/graph/Graph.tsx","pages/form-builders/stage-builder/controls/Controls.tsx","components/form/custom-widgets/AudioWidget.tsx","components/form/custom-widgets/AutoCompleteWidget.tsx","components/form/custom-widgets/CustomLinkWidget.tsx","components/form/custom-widgets/FixedRadioWidget.tsx","components/form/Form.tsx","components/form-builder/custom-fields/AudioType.tsx","components/form-builder/custom-fields/AutoCompleteType.tsx","components/form-builder/custom-fields/CustomFileType.tsx","components/form-builder/custom-fields/CustomLinkType.tsx","components/form-builder/FormBuilder.tsx","components/layout/common-layouts/BuilderLayout.tsx","pages/form-builders/stage-builder/builder/Builder.tsx","components/text-editor/TextViewer.tsx","pages/form-builders/stage-builder/preview/Preview.tsx","pages/form-builders/stage-builder/schema-editor/SchemaEditor.tsx","pages/form-builders/stage-builder/plugins/Plugin.tsx","pages/form-builders/stage-builder/plugins/Plugins.tsx","components/text-editor/TextEditor.tsx","pages/form-builders/stage-builder/text/Text.tsx","pages/form-builders/stage-builder/StageBuilder.tsx","pages/form-builders/logic-builder/LogicBuilder.tsx","pages/chains/create-chain/CreateChain.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["auth","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","getAuth","provider","GoogleAuthProvider","setCustomParameters","prompt","AuthContext","React","createContext","AuthProvider","children","useState","user","setUser","ready","setReady","useEffect","onIdTokenChanged","a","value","getToken","getIdToken","login","callback","signInWithPopup","then","result","console","log","logout","signOut","Provider","useAuth","useContext","ROUTES","title","path","RequireAuth","location","useLocation","to","state","from","CircularProgress","chainsUrl","taskstagesUrl","conditionalstagesUrl","ToastContext","Alert","forwardRef","props","ref","elevation","variant","ToastProvider","open","setOpen","setTitle","setVariant","closeToast","event","reason","openToast","JSON","stringify","String","Snackbar","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","severity","sx","width","useToast","useAxios","axios","defaultAxios","create","baseURL","interceptors","request","use","config","token","headers","error","Promise","reject","getCampaigns","get","res","data","results","catch","err","message","getChains","campaignId","createChain","post","getStageNodes","chainId","getLogicNodes","getTaskStage","id","saveTaskStage","patch","getTaskStageOptions","options","getConditionalStage","saveConditionalStage","Card","onClick","name","description","CardContent","pb","Typography","component","gutterBottom","color","overflow","textOverflow","height","maxWidth","CardActions","Button","size","ExpandMore","styled","expand","other","IconButton","theme","transform","marginLeft","transition","transitions","duration","shortest","ExpandableCard","hideExpandButton","hideOpenButton","setExpand","actions","push","aria-expanded","aria-label","CardHeader","action","Stack","direction","spacing","subheader","titleTypographyProps","subheaderTypographyProps","Collapse","in","timeout","unmountOnExit","ListContent","view","onSelect","Grid","container","py","xs","md","columns","sm","map","item","index","ListHeader","label","hideLabel","hideCreateButton","hideViewButton","onViewChange","alignItems","flex","hidden","Link","boxShadow","Tooltip","List","defaultView","setView","localStorage","getItem","Box","setItem","Campaigns","navigate","useNavigate","setData","px","Login","pathname","replace","drawerWidth","openedMixin","easing","sharp","enteringScreen","overflowX","closedMixin","leavingScreen","breakpoints","down","DrawerHeader","display","justifyContent","padding","mixins","toolbar","StyledAppBar","MuiAppBar","shouldForwardProp","prop","zIndex","drawer","Drawer","MuiDrawer","flexShrink","whiteSpace","boxSizing","Appbar","useTheme","useParams","DrawerItems","page","icon","CssBaseline","position","Toolbar","edge","marginRight","flexGrow","underline","noWrap","Divider","ListItem","ListItemIcon","ListItemText","primary","Layout","Chains","parsedId","parseInt","Node","type","fontSize","textAlign","palette","success","contrastText","backgroundColor","main","borderRadius","shape","BaseNode","Position","Top","style","Bottom","CustomLogicNode","CustomStageNode","useHelpers","getNode","elements","filter","node","pop","getUrl","updateConnections","currentNodeId","method","url","in_stages","out_stages","connections","parsed","connection","toString","ids","undefined","removeConnections","target","source","targetNode","sourceNode","createNode","x_pos","Math","round","x","y_pos","y","chain","stage","getFormFields","schema","formData","retrievedSchema","retrieveSchema","pathSchema","toPathSchema","getFieldNames","getAllPaths","_obj","acc","paths","Object","keys","forEach","key","newPaths","__rjsf_additionalProperties","$name","formValue","_get","_isEmpty","parseId","Error","addConnections","removeElements","elementsToRemove","nodeIdsToRemove","n","element","includes","isEdge","delete","updateNode","cursor","margin","Sidebar","draggable","setDraggable","setLabel","onDragStart","nodeLabel","nodeType","dataTransfer","effectAllowed","onDragEnd","mt","TextField","onChange","e","align","Graph","reactFlowWrapper","useRef","reactFlowInstance","setReactFlowInstance","setElements","parsedCampaignId","parsedChainId","extraEdgeOptions","strokeWidth","arrowHeadType","all","stageNodes","logicNodes","allNodes","nodes","parseFloat","length","sourceId","els","addEdge","onConnect","params","newParams","onDrop","preventDefault","reactFlowBounds","current","getBoundingClientRect","transfer","getData","project","clientX","left","clientY","top","parsedData","parse","newNode","es","onElementDoubleClick","nodeTypes","LOGIC","LogicNode","STAGE","StageNode","onElementsRemove","onNodeDoubleClick","onEdgeDoubleClick","onLoad","_reactFlowInstance","onDragOver","dropEffect","onNodeDragStop","preventScrolling","background","GoBackButton","dark","Controls","mode","allModes","onBack","p","fill","AudioWidget","required","disabled","readonly","onBlur","onFocus","TextWidget","placeholder","autofocus","rawErrors","inputType","Group","className","Label","Control","autoFocus","readOnly","list","examples","emptyValue","concat","default","example","CustomLinkWidget","href","RadioWidget","enumOptions","enumDisabled","_onChange","_onBlur","_onFocus","inline","Boolean","option","i","itemDisabled","Array","isArray","indexOf","checked","Check","Form","uiSchema","hideButton","onSubmit","widgets","customfile","autocomplete","AutoCompleteWidget","customlink","LinkWidget","audio","AudioType","displayName","matchIf","types","widget","possibleOptions","defaultDataSchema","defaultUiSchema","private","cardBody","parameters","ev","CustomAutoCompleteType","webhook","searchField","responseField","Fragment","paddingRight","paddingLeft","CustomFileType","file","multiple","CustomLinkType","link","FormBuilder","customFormInputs","AutoCompleteType","uischema","ui","mods","BuilderLayout","minWidth","Builder","onSchemaChange","onFormDataChange","optionsSchema","StageOptionsSchema","inStages","displayed_prev_stages","TextViewer","tinymceScriptSrc","process","init","plugins","menubar","image_advtab","importcss_append","Preview","text","SchemaEditor","isEditable","onUiChange","onIsEditableChange","onSave","onUndo","prettySchema","prettyUi","parsedSchema","parsedUi","FormGroup","my","FormControlLabel","control","Switch","inputProps","labelPlacement","m","multiline","fullWidth","InputProps","marginTop","marginBottom","Plugin","setSchema","getOptions","POST","transformOptionsToForm","DEFAULT_FORM_TYPES","properties","help_text","req","template","Plugins","TextEditor","onEditorChange","newValue","editor","toolbar_sticky","image_caption","noneditable_noneditable_class","toolbar_mode","contextmenu","autosave_prefix","content_style","Text","StageBuilder","stageId","setUiSchema","setFormData","viewMode","setViewMode","textEditorData","setTextEditorData","setEditable","tmpSchema","setTmpSchema","tmpUi","setTmpUi","originalSchema","setOriginalSchema","originalUi","setOriginalUi","VIEW_MODES","builder","preview","json_schema","ui_schema","rich_text","webhook_address","webhook_params","getStage","handleSchemaChange","handleFormDataChange","handleTextChange","d","handleIsEditableChange","handleTmpSchemaChange","handleTmpUiChange","handleTmpSave","handleTmpUndo","schemaJson","uiJson","renderContent","responses","parsed_webhook_params","saveData","LogicBuilder","isPingPong","setPingPong","connectedStages","setConnectedStages","fields","setFields","conditions","pingpong","taskStage","currentStage","connectedIds","connId","connStages","allFields","stageObject","values","stageSchema","dependencies","dependenciesValues","formFields","depFields","dep","hasOwnProperty","oneOf","allOf","nested","fictionalSchema","flat","getDependentFields","Set","items","field","enum","condition","Checkbox","CreateChain","campaign","alert","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b0021b6e.chunk.js","sourcesContent":["import {initializeApp} from 'firebase/app';\r\nimport {getAuth, GoogleAuthProvider} from \"firebase/auth\";\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyCXiwOUNsbzKH7sbSAZrqA9f7VOeCMdUOQ\",\r\n    authDomain: \"gigaturnip-b6b5b.firebaseapp.com\",\r\n    projectId: \"gigaturnip-b6b5b\",\r\n    storageBucket: \"gigaturnip-b6b5b.appspot.com\",\r\n    messagingSenderId: \"414429242328\",\r\n    appId: \"1:414429242328:web:a4685f5ac6895ea767c8ad\",\r\n    measurementId: \"G-Y8JTEJMTET\"\r\n};\r\n// Initialize Firebase\r\nconst app = initializeApp(firebaseConfig);\r\nconst auth = getAuth();\r\n\r\nconst provider = new GoogleAuthProvider();\r\nprovider.setCustomParameters({\r\n    prompt: 'select_account'\r\n});\r\n\r\nexport {app, auth, provider};","import React, {useEffect, useState} from \"react\";\r\nimport {auth, provider} from \"../../services/firebase/Firebase\";\r\nimport {signInWithPopup, getIdToken, signOut, onIdTokenChanged} from \"firebase/auth\";\r\n\r\ninterface AuthContextType {\r\n    user: any;\r\n    ready: boolean;\r\n    getToken: () => Promise<string>;\r\n    login: (callback: VoidFunction) => void;\r\n    logout: (callback: VoidFunction) => void;\r\n}\r\n\r\nexport const AuthContext = React.createContext<AuthContextType>(null!);\r\n\r\nconst AuthProvider = ({children}: { children: React.ReactNode }) => {\r\n    const [user, setUser] = useState<any>(null);\r\n    const [ready, setReady] = useState(false);\r\n\r\n    useEffect(() => {\r\n        onIdTokenChanged(auth, async (user) => {\r\n            if (user) {\r\n                setUser(user)\r\n            } else {\r\n                setUser(null)\r\n            }\r\n            setReady(true)\r\n        });\r\n    }, [])\r\n\r\n    const getToken = async () => {\r\n        return await getIdToken(user);\r\n    }\r\n\r\n    const login = (callback: VoidFunction) => {\r\n        return signInWithPopup(auth, provider).then((result) => {\r\n            const user = result.user;\r\n            console.log(user)\r\n            setUser(user);\r\n            callback();\r\n        });\r\n    };\r\n\r\n    const logout = (callback: VoidFunction) => {\r\n        return signOut(auth).then(() => {\r\n            setUser(null);\r\n            callback();\r\n        });\r\n    };\r\n\r\n    const value = {user, ready, getToken, login, logout};\r\n\r\n    return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\nexport default AuthProvider","import React from \"react\";\r\nimport {AuthContext} from \"../AuthProvider\";\r\n\r\nexport const useAuth = () => React.useContext(AuthContext);","\r\nexport const ROUTES = {\r\n    login: {title: \"Login\", path: \"/login\"},\r\n    campaigns: {title: \"Campaign\", path: \"/campaigns\"}\r\n}","import {useAuth} from \"../../context/authentication/hooks/useAuth\";\r\nimport {useLocation, Navigate} from \"react-router-dom\";\r\nimport {ROUTES} from \"../../utils/constants/Paths\";\r\nimport {CircularProgress} from \"@mui/material\";\r\n\r\nconst RequireAuth = ({ children }: { children: JSX.Element }) => {\r\n  const auth = useAuth();\r\n  const location = useLocation();\r\n\r\n  console.log(auth)\r\n\r\n  if (auth.ready && !auth.user) {\r\n    return <Navigate to={ROUTES.login.path} state={{ from: location }} />;\r\n  }\r\n\r\n  return auth.ready ? children : <CircularProgress/>;\r\n};\r\n\r\nexport default RequireAuth","const baseUrl = \"https://journal-bb5e3.uc.r.appspot.com/\"\r\n// const baseUrl = \"http://127.0.0.1:8000/\"\r\nconst campaignsUrl = \"api/v1/campaigns/\"\r\nconst chainsUrl = \"api/v1/chains/\"\r\nconst taskstagesUrl = \"api/v1/taskstages/\"\r\nconst ranksUrl = \"api/v1/ranks/\"\r\nconst rankslimitsUrl = \"api/v1/ranklimits/\"\r\nconst webhookstagesUrl = \"api/v1/webhookstages/\"\r\nconst conditionalstagesUrl = \"api/v1/conditionalstages/\"\r\nconst manualstagesUrl = \"api/v1/manualstages/\" // TBD\r\nconst casesUrl = \"api/v1/cases/\"\r\nconst tasksUrl = \"api/v1/tasks/\"\r\n\r\nexport {\r\n    baseUrl,\r\n    campaignsUrl,\r\n    chainsUrl,\r\n    taskstagesUrl,\r\n    ranksUrl,\r\n    rankslimitsUrl,\r\n    webhookstagesUrl,\r\n    conditionalstagesUrl,\r\n    casesUrl,\r\n    tasksUrl,\r\n    manualstagesUrl\r\n}","import React, {useEffect, useState} from \"react\";\r\nimport {Alert as MuiAlert, AlertProps, Snackbar} from \"@mui/material\";\r\n\r\ninterface ToastContextType {\r\n    open: boolean;\r\n    openToast: (title: string, variant?: ToastVariants) => void;\r\n    closeToast: (event?: React.SyntheticEvent | Event, reason?: string) => void;\r\n}\r\n\r\ntype ToastVariants = \"success\" | \"error\" | \"warning\" | \"info\";\r\n\r\nexport const ToastContext = React.createContext<ToastContextType>(null!);\r\n\r\nconst Alert = React.forwardRef<HTMLDivElement, AlertProps>(function Alert(\r\n    props,\r\n    ref,\r\n) {\r\n    return <MuiAlert elevation={6} ref={ref} variant=\"filled\" {...props} />;\r\n});\r\n\r\nconst ToastProvider = ({children}: { children: React.ReactNode }) => {\r\n    const [open, setOpen] = useState(false);\r\n    const [title, setTitle] = useState<any>(\"\");\r\n    const [variant, setVariant] = useState<ToastVariants>(\"error\")\r\n\r\n    const stringify = (value: any) => {\r\n        switch (typeof value) {\r\n            case 'string':\r\n                return value;\r\n            case 'object':\r\n                return JSON.stringify(value);\r\n            default:\r\n                return String(value);\r\n        }\r\n    };\r\n\r\n    const openToast = (title: string, variant?: ToastVariants) => {\r\n        if (variant) {\r\n            setVariant(variant)\r\n        }\r\n        setTitle(stringify(title))\r\n        setOpen(true);\r\n    };\r\n\r\n    const closeToast = (event?: React.SyntheticEvent | Event, reason?: string) => {\r\n        if (reason === 'clickaway') {\r\n            return;\r\n        }\r\n\r\n        setOpen(false);\r\n    };\r\n\r\n    const value = {open, openToast, closeToast};\r\n\r\n    return <ToastContext.Provider value={value}>\r\n        <Snackbar open={open} autoHideDuration={5000} onClose={closeToast}\r\n                  anchorOrigin={{\r\n                      vertical: 'top',\r\n                      horizontal: 'center',\r\n                  }}\r\n        >\r\n            <Alert onClose={closeToast} severity={variant} sx={{width: '100%'}}>\r\n                {title}\r\n            </Alert>\r\n        </Snackbar>\r\n        {children}\r\n    </ToastContext.Provider>;\r\n};\r\n\r\nexport default ToastProvider","import React from \"react\";\r\nimport {ToastContext} from \"../ToastProvider\";\r\n\r\nexport const useToast = () => React.useContext(ToastContext);","import {baseUrl, campaignsUrl, chainsUrl, conditionalstagesUrl, taskstagesUrl} from \"./Urls\";\r\nimport React from \"react\";\r\nimport defaultAxios from \"axios\";\r\nimport {useAuth} from \"../../context/authentication/hooks/useAuth\";\r\nimport {useToast} from \"../../context/toast/hooks/useToast\";\r\n\r\n\r\nconst useAxios = () => {\r\n    const {openToast} = useToast();\r\n    const {getToken} = useAuth();\r\n    const axios = defaultAxios.create({\r\n        baseURL: baseUrl\r\n    });\r\n\r\n    axios.interceptors.request.use(\r\n        config => {\r\n            return getToken().then(token => {\r\n                if (token && config && config.headers) {\r\n                    config.headers[\"Authorization\"] = 'JWT ' + token;\r\n                }\r\n                return config;\r\n            });\r\n        },\r\n        error => Promise.reject(error)\r\n    );\r\n\r\n\r\n    const getCampaigns = () => {\r\n        return axios.get(`${campaignsUrl}?limit=1000`)\r\n            .then(res => res.data)\r\n            .then(res => res.results)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const getChains = (campaignId: number) => {\r\n        return axios.get(`${chainsUrl}?campaign=${campaignId}&limit=1000`)\r\n            .then(res => res.data)\r\n            .then(res => res.results)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const createChain = (data: { name: string, campaign: number, description?: string }) => {\r\n        return axios.post(`${chainsUrl}`, data)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const getStageNodes = (campaignId: number, chainId: number) => {\r\n        return axios.get(`${taskstagesUrl}?chain__campaign=${campaignId}&chain=${chainId}&limit=1000`)\r\n            .then(res => res.data)\r\n            .then(res => res.results)\r\n            .catch((err) => openToast(err.message));\r\n    };\r\n\r\n    const getLogicNodes = (campaignId: number, chainId: number) => {\r\n        return axios.get(`${conditionalstagesUrl}?chain__campaign=${campaignId}&chain=${chainId}&limit=1000`)\r\n            .then(res => res.data)\r\n            .then(res => res.results)\r\n            .catch((err) => openToast(err.message));\r\n    };\r\n\r\n    const getTaskStage = (id: number) => {\r\n        return axios.get(`${taskstagesUrl + id}/`)\r\n            .then(res => res.data)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const saveTaskStage = (id: number, data: any) => {\r\n        return axios.patch(`${taskstagesUrl + id}/`, data)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const getTaskStageOptions = () => {\r\n        return axios.options(`${taskstagesUrl}`)\r\n            .then(res => res.data)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const getConditionalStage = (id: number) => {\r\n        return axios.get(`${conditionalstagesUrl + id}/`)\r\n            .then(res => res.data)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    const saveConditionalStage = (id: number, data: any) => {\r\n        return axios.patch(`${conditionalstagesUrl + id}/`, data)\r\n            .catch((err) => openToast(err.message));\r\n    }\r\n\r\n    return {\r\n        axios,\r\n        getCampaigns,\r\n        getChains,\r\n        createChain,\r\n        getStageNodes,\r\n        getLogicNodes,\r\n        getTaskStage,\r\n        saveTaskStage,\r\n        getTaskStageOptions,\r\n        getConditionalStage,\r\n        saveConditionalStage\r\n    }\r\n}\r\n\r\nexport default useAxios;","import React from 'react';\r\nimport {Button, CardActions, CardContent, Typography} from '@mui/material'\r\nimport MuiCard from '@mui/material/Card';\r\n\r\ntype Props = {\r\n    data: any;\r\n    onClick: (id: number) => void;\r\n};\r\n\r\nconst Card = (props: Props) => {\r\n    const {data, onClick} = props;\r\n    const {name, description, id} = data;\r\n\r\n    const handleClick = () => {\r\n        onClick(id)\r\n    }\r\n\r\n    return (\r\n        <MuiCard>\r\n            <CardContent sx={{pb: 1}}>\r\n                <Typography variant=\"h5\" component=\"div\">\r\n                    {name}\r\n                </Typography>\r\n                <Typography gutterBottom variant={\"caption\"} color=\"text.secondary\">ID: {id}</Typography>\r\n                <Typography overflow={\"hidden\"} textOverflow={\"ellipsis\"} variant=\"body2\" sx={{height: 60, maxWidth: 500}}>\r\n                    {description}\r\n                </Typography>\r\n            </CardContent>\r\n            <CardActions>\r\n                <Button size=\"small\" onClick={handleClick}>Открыть</Button>\r\n            </CardActions>\r\n        </MuiCard>\r\n    );\r\n};\r\n\r\nexport default Card","import React, {useState} from 'react';\r\nimport CardHeader from \"@mui/material/CardHeader\";\r\nimport {Button, Stack} from \"@mui/material\";\r\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\r\nimport Collapse from \"@mui/material/Collapse\";\r\nimport CardContent from \"@mui/material/CardContent\";\r\nimport Card from \"@mui/material/Card\";\r\nimport {styled} from \"@mui/material/styles\";\r\nimport IconButton, {IconButtonProps} from \"@mui/material/IconButton\";\r\n\r\ntype Props = {\r\n    data: any,\r\n    hideExpandButton?: boolean,\r\n    hideOpenButton?: boolean,\r\n    onClick?: (id: number) => void\r\n};\r\n\r\ninterface ExpandMoreProps extends IconButtonProps {\r\n    expand: boolean;\r\n}\r\n\r\nconst ExpandMore = styled((props: ExpandMoreProps) => {\r\n    const {expand, ...other} = props;\r\n    return <IconButton {...other} />;\r\n})(({theme, expand}) => ({\r\n    transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',\r\n    marginLeft: 'auto',\r\n    transition: theme.transitions.create('transform', {\r\n        duration: theme.transitions.duration.shortest,\r\n    }),\r\n}));\r\n\r\nconst ExpandableCard: React.FC<Props> = (props) => {\r\n    const {data, children, hideExpandButton, hideOpenButton, onClick} = props;\r\n    const {name, description, id} = data;\r\n    const [expand, setExpand] = useState(false);\r\n\r\n    const handleToggle = () => {\r\n        setExpand(!expand)\r\n    }\r\n\r\n    const handleClick = () => {\r\n        if (onClick) {\r\n            onClick(id)\r\n        }\r\n    }\r\n\r\n    const actions = [];\r\n    if (!hideOpenButton) {\r\n        actions.push(\r\n            <Button key={\"open_button\"} variant={\"contained\"} onClick={handleClick}>Открыть</Button>\r\n        )\r\n    }\r\n    if (!hideExpandButton) {\r\n        actions.push(\r\n            <ExpandMore\r\n                key={\"expand_button\"}\r\n                expand={expand}\r\n                onClick={handleToggle}\r\n                aria-expanded={expand}\r\n                aria-label=\"show more\"\r\n            >\r\n                <ExpandMoreIcon/>\r\n            </ExpandMore>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <Card>\r\n            <CardHeader\r\n                action={\r\n                    <Stack direction=\"row\" spacing={1}>\r\n                        {actions}\r\n                    </Stack>\r\n                }\r\n\r\n                title={name}\r\n                subheader={`ID: ${id}`}\r\n                titleTypographyProps={{variant: \"h6\"}}\r\n                subheaderTypographyProps={{variant: \"caption\"}}\r\n            />\r\n            <Collapse in={expand} timeout=\"auto\" unmountOnExit>\r\n                <CardContent>\r\n                    {children}\r\n                </CardContent>\r\n            </Collapse>\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport default ExpandableCard","import React from 'react';\r\nimport {Grid, Typography} from \"@mui/material\";\r\nimport Card from \"../card/Card\";\r\nimport ExpandableCard from \"../card/ExpandableCard\";\r\nimport {ViewProps} from \"./List.types\";\r\n\r\ntype Props = {\r\n    data: any[],\r\n    view: ViewProps,\r\n    onSelect: (id: number) => void\r\n};\r\n\r\nconst ListContent = (props: Props) => {\r\n    const {data, view, onSelect} = props;\r\n    if (!data) {\r\n        return <Typography>Error</Typography>;\r\n    }\r\n    if (view === \"grid\") {\r\n        return (\r\n            <Grid container py={2} spacing={{xs: 2, md: 3}} columns={{xs: 4, sm: 8, md: 12}}>\r\n                {data.map((item, index) =>\r\n                    <Grid item xs={2} sm={4} md={4} key={index}>\r\n                        <Card data={item} onClick={onSelect}/>\r\n                    </Grid>\r\n                )}\r\n            </Grid>\r\n        );\r\n    }\r\n    if (view === \"list\") {\r\n        return (\r\n            <Grid container py={2} spacing={2}>\r\n                {data.map((item, index) =>\r\n                    <Grid item xs={12} key={index}>\r\n                        <ExpandableCard data={item} hideExpandButton={true} onClick={onSelect}/>\r\n                    </Grid>\r\n                )}\r\n            </Grid>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport default ListContent","import React from 'react';\r\nimport {Button, Grid, IconButton, Tooltip, Typography} from \"@mui/material\";\r\nimport {Link} from \"react-router-dom\";\r\nimport GridViewIcon from \"@mui/icons-material/GridView\";\r\nimport ViewListIcon from \"@mui/icons-material/ViewList\";\r\nimport {ViewProps} from \"./List.types\";\r\n\r\ntype Props = {\r\n    label: string,\r\n    location: any,\r\n    view: ViewProps,\r\n    hideLabel?: boolean,\r\n    hideCreateButton?: boolean,\r\n    hideViewButton?: boolean,\r\n    onViewChange: (view: ViewProps) => void\r\n};\r\n\r\nconst ListHeader = (props: Props) => {\r\n    const {label, view, location, hideLabel, hideCreateButton, hideViewButton, onViewChange} = props;\r\n    return (\r\n        <Grid container alignItems={\"center\"} spacing={1}>\r\n            <Grid item flex={1}>\r\n                <Typography hidden={hideLabel} variant={\"h4\"}>{label}</Typography>\r\n            </Grid>\r\n            <Grid item hidden={hideCreateButton}>\r\n                <Button component={Link} to={\"new\"} state={{from: location}} variant={\"contained\"} sx={{\r\n                    '&:hover': {\r\n                        color: 'white',\r\n                        boxShadow: 'none',\r\n                    }\r\n                }}>Создать</Button>\r\n            </Grid>\r\n            <Grid item hidden={hideViewButton}>\r\n                <Tooltip title={\"Сетка\"}>\r\n                    <IconButton\r\n                        color={view === \"grid\" ? \"primary\" : \"default\"}\r\n                        onClick={() => onViewChange(\"grid\")}\r\n                    >\r\n                        <GridViewIcon/>\r\n                    </IconButton>\r\n                </Tooltip>\r\n                <Tooltip title={\"Список\"}>\r\n                    <IconButton\r\n                        color={view === \"list\" ? \"primary\" : \"default\"}\r\n                        onClick={() => onViewChange(\"list\")}\r\n                    >\r\n                        <ViewListIcon/>\r\n                    </IconButton>\r\n                </Tooltip>\r\n            </Grid>\r\n        </Grid>\r\n    );\r\n};\r\n\r\nexport default ListHeader","import React, {useEffect, useState} from 'react';\r\nimport {Box} from \"@mui/material\";\r\nimport {useLocation} from \"react-router-dom\";\r\nimport ListContent from \"./ListContent\";\r\nimport ListHeader from \"./ListHeader\";\r\nimport {ViewProps} from \"./List.types\";\r\n\r\n\r\ntype Props = {\r\n    data: any[],\r\n    id: string,\r\n    label: string,\r\n    hideLabel?: boolean,\r\n    defaultView?: ViewProps;\r\n    hideCreateButton?: boolean,\r\n    hideViewButton?: boolean,\r\n    onSelect: (id: number) => void,\r\n};\r\n\r\nconst List = (props: Props) => {\r\n    const {id, data, label, defaultView, hideLabel, hideCreateButton, hideViewButton, onSelect} = props;\r\n    const location = useLocation();\r\n\r\n    const [view, setView] = useState<ViewProps>(defaultView ?? \"grid\");\r\n\r\n    useEffect(() => {\r\n        if (!defaultView) {\r\n            const view = localStorage.getItem(`${id}_view`) as ViewProps || \"grid\";\r\n            if (view) {\r\n                setView(view)\r\n            }\r\n        }\r\n    }, [])\r\n\r\n    const handleViewChange = (view: ViewProps) => {\r\n        setView(view)\r\n        localStorage.setItem(`${id}_view`, view);\r\n    }\r\n\r\n    return (\r\n        <Box>\r\n            <ListHeader label={label} hideLabel={hideLabel} view={view} onViewChange={handleViewChange} location={location}\r\n                        hideCreateButton={hideCreateButton} hideViewButton={hideViewButton}/>\r\n            <ListContent data={data} view={view} onSelect={onSelect}/>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default List","import React, {useEffect, useState} from \"react\";\r\nimport useAxios from \"../../services/api/useAxios\";\r\nimport {Box} from \"@mui/material\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport List from \"../../components/list/List\";\r\n\r\nconst Campaigns = () => {\r\n    const {getCampaigns} = useAxios()\r\n    const navigate = useNavigate();\r\n\r\n    const [data, setData] = useState([])\r\n\r\n    useEffect(() => {\r\n        getCampaigns().then(res => setData(res))\r\n    }, [])\r\n\r\n    const handleSelect = (id: number) => {\r\n        navigate(`/campaign/${id}/chain`)\r\n    }\r\n\r\n    return (\r\n        <Box px={3} py={1}>\r\n            <List id={\"campaigns\"} data={data} hideCreateButton={true} label={\"Кампании\"} onSelect={handleSelect}/>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default Campaigns","import React, {useContext} from \"react\";\r\nimport {Button} from \"@mui/material\";\r\nimport {useAuth} from \"../../context/authentication/hooks/useAuth\";\r\nimport {useLocation, useNavigate} from \"react-router-dom\";\r\n\r\n\r\nconst Login = () => {\r\n    const {login} = useAuth();\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n\r\n    // @ts-ignore\r\n    const from = location?.state?.from?.pathname || \"/\";\r\n\r\n    const handleLogin = () => {\r\n        login(() => navigate(from, { replace: true }))\r\n    }\r\n\r\n    return <Button onClick={handleLogin}>Login</Button>\r\n}\r\n\r\nexport default Login","import React from 'react';\r\nimport {CSSObject, styled, Theme, useTheme} from '@mui/material/styles';\r\nimport Box from '@mui/material/Box';\r\nimport MuiDrawer from '@mui/material/Drawer';\r\nimport MuiLink from '@mui/material/Link';\r\nimport MuiAppBar, {AppBarProps as MuiAppBarProps} from '@mui/material/AppBar';\r\nimport Toolbar from '@mui/material/Toolbar';\r\nimport List from '@mui/material/List';\r\nimport CssBaseline from '@mui/material/CssBaseline';\r\nimport Divider from '@mui/material/Divider';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport ChevronLeftIcon from '@mui/icons-material/ChevronLeft';\r\nimport ChevronRightIcon from '@mui/icons-material/ChevronRight';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemIcon from '@mui/material/ListItemIcon';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport InboxIcon from '@mui/icons-material/MoveToInbox';\r\nimport {Link, useNavigate, useParams} from \"react-router-dom\";\r\nimport {Button} from \"@mui/material\";\r\nimport {useAuth} from \"../../../context/authentication/hooks/useAuth\";\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst openedMixin = (theme: Theme): CSSObject => ({\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n});\r\n\r\nconst closedMixin = (theme: Theme): CSSObject => ({\r\n    transition: theme.transitions.create('width', {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: `calc(${theme.spacing(7)} + 1px)`,\r\n    [theme.breakpoints.down('sm')]: {\r\n        width: 0,\r\n    }\r\n});\r\n\r\nconst DrawerHeader = styled('div')(({theme}) => ({\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n}));\r\n\r\ninterface AppBarProps extends MuiAppBarProps {\r\n    open?: boolean;\r\n}\r\n\r\nconst StyledAppBar = styled(MuiAppBar, {\r\n    shouldForwardProp: (prop) => prop !== 'open',\r\n})<AppBarProps>(({theme, open}) => ({\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    ...(open && {\r\n        marginLeft: drawerWidth,\r\n        width: `calc(100% - ${drawerWidth}px)`,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen,\r\n        }),\r\n    }),\r\n}));\r\n\r\nconst Drawer = styled(MuiDrawer, {shouldForwardProp: (prop) => prop !== 'open'})(\r\n    ({theme, open}) => ({\r\n        width: drawerWidth,\r\n        flexShrink: 0,\r\n        whiteSpace: 'nowrap',\r\n        boxSizing: 'border-box',\r\n        ...(open && {\r\n            ...openedMixin(theme),\r\n            '& .MuiDrawer-paper': openedMixin(theme),\r\n        }),\r\n        ...(!open && {\r\n            ...closedMixin(theme),\r\n            '& .MuiDrawer-paper': closedMixin(theme),\r\n        }),\r\n    }),\r\n);\r\n\r\nexport default function Appbar(props: { children?: any }) {\r\n    const theme = useTheme();\r\n    const {campaignId} = useParams();\r\n    const navigate = useNavigate();\r\n    const {logout} = useAuth();\r\n    const [open, setOpen] = React.useState(false);\r\n    const {children} = props;\r\n\r\n    const handleDrawerOpen = () => {\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleDrawerClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const DrawerItems = [\r\n        {page: \"chain\", title: \"Цепочки\", icon: <InboxIcon/>}\r\n    ]\r\n\r\n    const renderDrawerItems = () => {\r\n        return DrawerItems.map(item => (\r\n            <ListItem component={Link} to={`campaign/${campaignId}/${item.page}`}>\r\n                <ListItemIcon>\r\n                    {item.icon}\r\n                </ListItemIcon>\r\n                <ListItemText primary={item.title}/>\r\n            </ListItem>\r\n        ));\r\n    };\r\n\r\n    return (\r\n        <Box sx={{display: 'flex'}}>\r\n            <CssBaseline/>\r\n            <StyledAppBar position=\"fixed\" open={open}>\r\n                <Toolbar>\r\n                    {campaignId && <IconButton\r\n                        color=\"inherit\"\r\n                        aria-label=\"open drawer\"\r\n                        onClick={handleDrawerOpen}\r\n                        edge=\"start\"\r\n                        sx={{\r\n                            marginRight: '36px',\r\n                            ...(open && {display: 'none'}),\r\n                        }}\r\n                    >\r\n                        <MenuIcon/>\r\n                    </IconButton>}\r\n                    <Box sx={{flexGrow: 1}}>\r\n                        <MuiLink component={Link} color={\"inherit\"} underline=\"none\" variant=\"h6\" noWrap to={\"/\"} sx={{\r\n                            '&:hover': {\r\n                                color: 'white',\r\n                                boxShadow: 'none',\r\n                            }\r\n                        }}>\r\n                            GigaTurnip Admin Interface\r\n                        </MuiLink>\r\n                    </Box>\r\n                    <Button color={\"inherit\"} onClick={() => logout(() => navigate('/'))}>Выход</Button>\r\n                </Toolbar>\r\n            </StyledAppBar>\r\n            {campaignId && <Drawer variant=\"permanent\" open={open}>\r\n                <DrawerHeader>\r\n                    <IconButton onClick={handleDrawerClose}>\r\n                        {theme.direction === 'rtl' ? <ChevronRightIcon/> : <ChevronLeftIcon/>}\r\n                    </IconButton>\r\n                </DrawerHeader>\r\n                <Divider/>\r\n                <List>\r\n                    {renderDrawerItems()}\r\n                </List>\r\n            </Drawer>}\r\n            <Box component=\"main\" sx={{flexGrow: 1, width: \"100%\"}}>\r\n                <DrawerHeader/>\r\n                {children}\r\n            </Box>\r\n        </Box>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport Appbar from \"./appbar/Appbar\";\r\nimport { Outlet } from \"react-router-dom\";\r\n\r\nconst Layout = () => {\r\n    return (\r\n        <div>\r\n            <Appbar>\r\n                <Outlet />\r\n            </Appbar>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Layout","import React, {useEffect, useState} from 'react';\r\nimport {Box} from \"@mui/material\";\r\nimport useAxios from \"../../services/api/useAxios\";\r\nimport {useNavigate, useParams} from \"react-router-dom\";\r\nimport List from \"../../components/list/List\";\r\n\r\n\r\nconst Chains = () => {\r\n    const {getChains} = useAxios();\r\n    const navigate = useNavigate();\r\n    const {campaignId} = useParams()\r\n\r\n    const [data, setData] = useState([])\r\n\r\n    useEffect(() => {\r\n        if (campaignId) {\r\n            const parsedId = parseInt(campaignId)\r\n            getChains(parsedId).then(res => setData(res))\r\n        }\r\n    }, [])\r\n\r\n    const handleSelect = (id: number) => {\r\n        navigate(`${id}`)\r\n    }\r\n\r\n    return (\r\n        <Box px={3} py={1}>\r\n            <List\r\n                id={\"chains\"}\r\n                data={data}\r\n                label={\"Цепочки\"}\r\n                onSelect={handleSelect}\r\n            />\r\n        </Box>\r\n\r\n    );\r\n};\r\n\r\nexport default Chains","import React from 'react';\r\nimport {Handle, Position} from 'react-flow-renderer';\r\nimport {styled} from \"@mui/material/styles\";\r\nimport {NodeType} from \"./Node.types\";\r\nimport {Box, BoxProps as MuiBoxProps, Typography} from \"@mui/material\";\r\n\r\n\r\ninterface NodeProps extends MuiBoxProps {\r\n    type: \"logic\" | \"stage\";\r\n}\r\n\r\nconst Node = styled(Box)<NodeProps>(({theme, type}) => ({\r\n    fontSize: '12px',\r\n    width: '150px',\r\n    textAlign: 'center',\r\n    color: type === \"stage\" ? theme.palette.success.contrastText : theme.palette.primary.contrastText,\r\n    backgroundColor: type === \"stage\" ? theme.palette.success.main : theme.palette.primary.main,\r\n    padding: theme.spacing(1),\r\n    borderRadius: theme.shape.borderRadius,\r\n}));\r\n\r\n\r\nconst BaseNode = (props: NodeType) => {\r\n    const {data, type} = props;\r\n\r\n    return (\r\n        <Node type={type}>\r\n            <Typography>{data.label}</Typography>\r\n            <Handle\r\n                type=\"target\"\r\n                position={Position.Top}\r\n                style={{borderRadius: '100%', width: 10, height: 10}}\r\n            />\r\n            <Handle\r\n                type=\"source\"\r\n                position={Position.Bottom}\r\n                style={{borderRadius: '100%', width: 10, height: 10}}\r\n            />\r\n        </Node>\r\n    );\r\n};\r\n\r\nexport default BaseNode","import React from 'react';\r\nimport BaseNode from \"./BaseNode\";\r\nimport {NodeType} from \"./Node.types\";\r\nimport {styled} from \"@mui/material/styles\";\r\n\r\nconst Node = styled(BaseNode)(({theme}) => ({\r\n    // borderColor: '#0041d0'\r\n    color: theme.palette.primary.contrastText,\r\n    backgroundColor: theme.palette.primary.main,\r\n}));\r\n\r\nconst CustomLogicNode = ({data}: NodeType) => <Node data={data} type={\"logic\"}/>;\r\n\r\nexport default CustomLogicNode","import React from 'react';\r\nimport BaseNode from \"./BaseNode\";\r\nimport {NodeType} from \"./Node.types\";\r\nimport {styled} from \"@mui/material/styles\";\r\n\r\n\r\nconst Node = styled(BaseNode)(({theme}) => ({\r\n    // borderColor: '#32CD32'\r\n    color: theme.palette.success.contrastText,\r\n    backgroundColor: theme.palette.success.main,\r\n}));\r\n\r\nconst CustomStageNode = ({ data }: NodeType) => <Node data={data} type={\"stage\"} />;\r\n\r\nexport default CustomStageNode","import {FlowElement} from \"react-flow-renderer\";\r\nimport {conditionalstagesUrl, taskstagesUrl} from \"../../services/api/Urls\";\r\nimport {ConnectionsParams} from \"./Helpers.types\";\r\nimport {isEdge} from \"react-flow-renderer\";\r\nimport useAxios from \"../../services/api/useAxios\";\r\n// @ts-ignore\r\nimport {retrieveSchema, toPathSchema} from \"@rjsf/core/lib/utils\";\r\n// @ts-ignore\r\nimport _get from \"lodash/get\";\r\n// @ts-ignore\r\nimport _isEmpty from \"lodash/isEmpty\";\r\n\r\nconst useHelpers = () => {\r\n    const {axios} = useAxios();\r\n\r\n    /**\r\n     * Get flatten fields from schema\r\n     * @param schema\r\n     * @param formData\r\n     * @returns {*[]}\r\n     */\r\n    const getFormFields = (schema: any, formData = {}) => {\r\n        const retrievedSchema = retrieveSchema(\r\n            schema\r\n        );\r\n\r\n        const pathSchema = toPathSchema(\r\n            retrievedSchema,\r\n            \"\",\r\n            schema,\r\n            formData\r\n        );\r\n\r\n        const getFieldNames = (pathSchema: any, formData: any) => {\r\n            const getAllPaths = (_obj:any, acc:any[] = [], paths = [\"\"]) => {\r\n                Object.keys(_obj).forEach(key => {\r\n                    if (typeof _obj[key] === \"object\") {\r\n                        let newPaths = paths.map(path => `${path}.${key}`);\r\n                        // If an object is marked with additionalProperties, all its keys are valid\r\n                        if (_obj[key].__rjsf_additionalProperties && _obj[key].$name !== \"\") {\r\n                            acc.push(_obj[key].$name);\r\n                        } else {\r\n                            getAllPaths(_obj[key], acc, newPaths);\r\n                        }\r\n                    } else if (key === \"$name\" && _obj[key] !== \"\") {\r\n                        paths.forEach(path => {\r\n                            path = path.replace(/^\\./, \"\");\r\n                            const formValue = _get(formData, path);\r\n                            // adds path to fieldNames if it points to a value\r\n                            // or an empty object/array\r\n                            if (typeof formValue !== \"object\" || _isEmpty(formValue)) {\r\n                                acc.push(path);\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                return acc;\r\n            };\r\n            return getAllPaths(pathSchema);\r\n        };\r\n\r\n        return getFieldNames(pathSchema, formData);\r\n    };\r\n\r\n    const parseId = (id: string | undefined) => {\r\n        if (id) {\r\n            return parseInt(id)\r\n        } else {\r\n            throw new Error(\"No id\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Search node in elements (state) and return it.\r\n     * @param id\r\n     * @param elements\r\n     * @return {FlowElement | undefined}\r\n     */\r\n    const getNode = (id: number, elements: FlowElement[]) => {\r\n        return elements.filter((node: any) => node.id === id).pop()\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param node\r\n     * @returns {string | undefined}\r\n     */\r\n    const getUrl = (node: FlowElement) => {\r\n        if (node.type === \"STAGE\") {\r\n            return taskstagesUrl\r\n        }\r\n        if (node.type === \"LOGIC\") {\r\n            return conditionalstagesUrl\r\n        }\r\n        return undefined\r\n    }\r\n\r\n    /**\r\n     * Add or remove connections (in_stages && out_stages) in database via API\r\n     * @param node - Source or Target of the current node\r\n     * @param currentNodeId\r\n     * @param type - 'in' (Incoming) or 'out' (Outgoing) connection\r\n     * @param method - 'create' or 'delete'\r\n     * @returns {Promise<void>}\r\n     */\r\n    const updateConnections = async ({node, currentNodeId, type, method}: ConnectionsParams) => {\r\n        // Returns url of given node type (logic or stage or undefined)\r\n        const url = getUrl(node)\r\n        if (url) {\r\n            // Get connections of a given node\r\n            const connections = await axios.get(url + node.id + '/').then(res => {\r\n                if (type === 'in') {\r\n                    return res.data.in_stages\r\n                }\r\n                if (type === 'out') {\r\n                    return res.data.out_stages\r\n                }\r\n                return undefined;\r\n            }).catch(err => undefined);\r\n\r\n            if (connections) {\r\n                // Change ids type to String\r\n                let parsed = connections.map((connection: number) => connection.toString())\r\n\r\n                let ids = []\r\n                // Add current node id to given node connections\r\n                if (method === 'create') {\r\n                    ids = [currentNodeId, ...parsed]\r\n                }\r\n                if (method === 'delete') {\r\n                    ids = parsed.filter((connection: string) => connection !== currentNodeId)\r\n                }\r\n\r\n                let data = undefined\r\n                if (type === 'in') {\r\n                    data = {in_stages: ids}\r\n                }\r\n                if (type === 'out') {\r\n                    data = {out_stages: ids}\r\n                }\r\n                if (data) {\r\n                    console.log(data)\r\n                    axios.patch(url + node.id + '/', data)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const addConnections = (target: number, source: number, elements: FlowElement[]) => {\r\n        const targetNode = getNode(target, elements)\r\n        const sourceNode = getNode(source, elements)\r\n\r\n        if (targetNode) {\r\n            updateConnections({node: targetNode, currentNodeId: source, type: 'in', method: 'create'})\r\n        }\r\n\r\n        if (sourceNode) {\r\n            updateConnections({node: sourceNode, currentNodeId: target, type: 'out', method: 'create'})\r\n        }\r\n    }\r\n\r\n\r\n    const removeConnections = (target: number, source: number, elements: FlowElement[]) => {\r\n        const targetNode = getNode(target, elements)\r\n        const sourceNode = getNode(source, elements)\r\n\r\n        if (targetNode) {\r\n            updateConnections({node: targetNode, currentNodeId: source, type: 'in', method: 'delete'})\r\n        }\r\n\r\n        if (sourceNode) {\r\n            updateConnections({node: sourceNode, currentNodeId: target, type: 'out', method: 'delete'})\r\n        }\r\n    }\r\n\r\n    const removeElements = (elementsToRemove: FlowElement[], elements: FlowElement[]) => {\r\n        const nodeIdsToRemove = elementsToRemove.map((n: any) => {\r\n            return n.id;\r\n        });\r\n\r\n        return elements.filter((element: any) => {\r\n            if (nodeIdsToRemove.includes(element.id)) {\r\n                if (isEdge(element)) {\r\n                    let target = parseInt(element.target)\r\n                    let source = parseInt(element.source)\r\n\r\n                    removeConnections(target, source, elements)\r\n\r\n                } else {\r\n                    const url = getUrl(element)\r\n                    if (url) {\r\n                        axios.delete(url + element.id + '/')\r\n                    }\r\n                }\r\n                return false\r\n            } else {\r\n                return true\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Update node (stage) coordinates in database via API\r\n     * @param node\r\n     */\r\n    const updateNode = (node: any) => {\r\n        const x_pos = Math.round(node.position.x);\r\n        const y_pos = Math.round(node.position.y);\r\n        const data = {x_pos, y_pos};\r\n        const url = getUrl(node)\r\n        console.log(data)\r\n        if (url) {\r\n            axios.patch(url + node.id + '/', data).then(res => console.log(res.data))\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create node (stage) in database via API\r\n     * @param node\r\n     * @param chainId\r\n     * @returns {Promise<string | undefined>}\r\n     */\r\n    const createNode = async (node: { type: string, position: { x: number, y: number }, label: string }, chainId: number) => {\r\n        const data = {\r\n            name: node.label,\r\n            x_pos: Math.round(node.position.x),\r\n            y_pos: Math.round(node.position.y),\r\n            chain: chainId,\r\n            out_stages: []\r\n        };\r\n\r\n        const url = getUrl(node as any)\r\n        if (url) {\r\n            const stage = await axios.post(url, data).then(res => res.data).catch(err => console.log(err));\r\n            return stage.id.toString()\r\n        }\r\n        return undefined;\r\n    }\r\n    return {\r\n        getFormFields,\r\n        parseId,\r\n        getNode,\r\n        getUrl,\r\n        updateConnections,\r\n        addConnections,\r\n        removeConnections,\r\n        removeElements,\r\n        updateNode,\r\n        createNode\r\n    };\r\n};\r\n\r\nexport default useHelpers\r\n","import React, {useEffect, useState} from 'react';\r\nimport {Box, Grid, TextField, Typography} from \"@mui/material\";\r\nimport {styled} from \"@mui/material/styles\";\r\n\r\n\r\nconst Node = styled(Box)<{ type: \"stage\" | \"logic\" }>(({theme, type}) => ({\r\n    fontSize: '12px',\r\n    width: '150px',\r\n    textAlign: 'center',\r\n    color: type === \"stage\" ? theme.palette.success.contrastText : theme.palette.primary.contrastText,\r\n    backgroundColor: type === \"stage\" ? theme.palette.success.main : theme.palette.primary.main,\r\n    padding: theme.spacing(1),\r\n    borderRadius: theme.shape.borderRadius,\r\n    cursor: \"grab\",\r\n    margin: 8,\r\n}));\r\n\r\nconst Sidebar = () => {\r\n    const [draggable, setDraggable] = useState(false)\r\n    const [label, setLabel] = useState(\"\")\r\n\r\n    useEffect(() => {\r\n        if (label && label !== \"\") {\r\n            setDraggable(true)\r\n        } else {\r\n            setDraggable(false)\r\n        }\r\n    }, [label])\r\n\r\n    const onDragStart = (event: { dataTransfer: DataTransfer }, nodeLabel: string, nodeType: string) => {\r\n        let data = JSON.stringify({label, type: nodeType})\r\n        event.dataTransfer.setData('application/reactflow', data);\r\n        event.dataTransfer.effectAllowed = 'move';\r\n    };\r\n\r\n    const onDragEnd = () => {\r\n        setLabel(\"\")\r\n    }\r\n\r\n    return (\r\n        <Grid item container justifyContent={\"center\"} px={1}>\r\n            <Grid container item mt={2} justifyContent={\"center\"}>\r\n                <TextField label={\"Label\"} size=\"small\" value={label} onChange={(e) => setLabel(e.target.value)}/>\r\n                <Typography py={1} variant={\"caption\"} color={\"red\"} align={\"center\"}>\r\n                    {!draggable && 'Enter label to drag the node'}\r\n                </Typography>\r\n            </Grid>\r\n            <Grid item>\r\n                <Node type={\"stage\"} onDragEnd={onDragEnd}\r\n                      onDragStart={(event) => onDragStart(event, label ? label : '', 'STAGE')}\r\n                      draggable={draggable}>\r\n                    Taskstage Node\r\n                </Node>\r\n                <Node type={\"logic\"} onDragEnd={onDragEnd}\r\n                      onDragStart={(event) => onDragStart(event, label ? label : '', 'LOGIC')}\r\n                      draggable={draggable}>\r\n                    Conditional Node\r\n                </Node>\r\n            </Grid>\r\n        </Grid>\r\n    );\r\n};\r\n\r\nexport default Sidebar","// noinspection ES6MissingAwait,JSIgnoredPromiseFromCall\r\n\r\nimport React, {useEffect, useRef, useState} from 'react';\r\nimport ReactFlow, {addEdge, Controls, Edge, FlowElement} from 'react-flow-renderer';\r\nimport LogicNode from './nodes/LogicNode'\r\nimport StageNode from './nodes/StageNode'\r\n\r\nimport './css/dnd.css';\r\nimport {useNavigate, useParams} from \"react-router-dom\";\r\nimport useHelpers from \"../../utils/hooks/UseHelpers\";\r\nimport useAxios from \"../../services/api/useAxios\";\r\nimport {Grid} from \"@mui/material\";\r\nimport Sidebar from \"./sidebar/Sidebar\";\r\n\r\n\r\nconst Graph = () => {\r\n    const reactFlowWrapper = useRef(null);\r\n    const {getStageNodes, getLogicNodes} = useAxios();\r\n    const {parseId, addConnections, createNode, removeElements, updateNode} = useHelpers();\r\n    const {campaignId, chainId} = useParams();\r\n    const [reactFlowInstance, setReactFlowInstance] = useState(null);\r\n    const [elements, setElements] = useState<FlowElement[]>([]);\r\n    const navigate = useNavigate();\r\n\r\n    const parsedCampaignId: number = parseId(campaignId);\r\n    const parsedChainId: number = parseId(chainId);\r\n    const extraEdgeOptions = {style: {strokeWidth: 3}, arrowHeadType: \"arrow\"}\r\n\r\n    // <------ UseEffect Part ------>\r\n    useEffect(() => {\r\n        Promise.all([getStageNodes(parsedCampaignId, parsedChainId), getLogicNodes(parsedCampaignId, parsedChainId)])\r\n            .then((results) => {\r\n                const stageNodes = results[0];\r\n                const logicNodes = results[1];\r\n\r\n                // Add types to nodes\r\n                stageNodes.forEach((node: any) => node.type = \"STAGE\")\r\n                logicNodes.forEach((node: any) => node.type = \"LOGIC\")\r\n\r\n                // Construct nodes and save to state\r\n                const allNodes = [...stageNodes, ...logicNodes]\r\n                const nodes: FlowElement[] = allNodes.map((node: any) => (\r\n                        {\r\n                            id: node.id.toString(),\r\n                            position: {x: parseFloat(node.x_pos), y: parseFloat(node.y_pos)},\r\n                            data: {label: node.name},\r\n                            type: node.type\r\n                        }\r\n                    )\r\n                )\r\n                setElements(nodes)\r\n                return allNodes\r\n            })\r\n            .then(allNodes => {\r\n                // Construct edges and save to state\r\n                allNodes.forEach(stage => {\r\n                    if (stage.in_stages.length > 0) {\r\n                        stage.in_stages.forEach((sourceId: string | number) => {\r\n                            const edge = {\r\n                                source: sourceId.toString(),\r\n                                target: stage.id.toString(),\r\n                                id: `${sourceId}-${stage.id}`,\r\n                                ...extraEdgeOptions\r\n                            } as Edge\r\n                            setElements((els) => addEdge(edge, els))\r\n                        })\r\n                    }\r\n                })\r\n            })\r\n    }, [parsedChainId])\r\n\r\n\r\n    // <------ Frameworks Functions Part ------>\r\n\r\n    const onConnect = async (params: object) => {\r\n        const newParams: any = {...params, ...extraEdgeOptions}\r\n        const target = newParams.target\r\n        const source = newParams.source\r\n\r\n        setElements((els: FlowElement[]) => addEdge(newParams, els))\r\n        addConnections(target, source, elements)\r\n    }\r\n\r\n    const onElementsRemove = (elementsToRemove: FlowElement[]) => {\r\n        setElements((els) => removeElements(elementsToRemove, els));\r\n    }\r\n\r\n    const onLoad = (_reactFlowInstance: any) =>\r\n        setReactFlowInstance(_reactFlowInstance);\r\n\r\n    const onDragOver = (event: any) => {\r\n        event.preventDefault();\r\n        event.dataTransfer.dropEffect = 'move';\r\n    };\r\n\r\n    const onDrop = async (event: any) => {\r\n        event.preventDefault();\r\n\r\n        // @ts-ignore\r\n        const reactFlowBounds = reactFlowWrapper.current.getBoundingClientRect();\r\n        // Get new node data from sidebar\r\n        const transfer = event.dataTransfer.getData('application/reactflow');\r\n        // @ts-ignore\r\n        const position = reactFlowInstance.project({\r\n            x: event.clientX - reactFlowBounds.left,\r\n            y: event.clientY - reactFlowBounds.top,\r\n        });\r\n\r\n        const parsedData = JSON.parse(transfer)\r\n        const label = parsedData.label\r\n        const type = parsedData.type\r\n\r\n        if (label === \"\") {\r\n            return 0;\r\n        }\r\n\r\n        const id = await createNode({type, position, label}, parsedChainId)\r\n\r\n        let newNode = {\r\n            id,\r\n            type,\r\n            position,\r\n            data: {label},\r\n        };\r\n\r\n        setElements((es) => [...es, newNode]);\r\n    };\r\n\r\n    const onNodeDragStop = (event: any, node: any) => {\r\n        updateNode(node)\r\n    }\r\n\r\n    const onElementDoubleClick = (event: any, element: any) => {\r\n        console.log(element)\r\n        if (element.id) {\r\n            if (element.type === 'LOGIC') {\r\n                navigate(`createlogic/${element.id}`)\r\n            }\r\n            if (element.type === 'STAGE') {\r\n                navigate(`createstage/${element.id}`)\r\n            }\r\n        }\r\n    }\r\n\r\n    // Init custom node types\r\n    const nodeTypes = {\r\n        LOGIC: LogicNode,\r\n        STAGE: StageNode\r\n    };\r\n\r\n\r\n    return (\r\n        <Grid container>\r\n            <Grid item md={10} zIndex={1}>\r\n                <ReactFlow\r\n                    ref={reactFlowWrapper}\r\n                    nodeTypes={nodeTypes}\r\n                    elements={elements}\r\n                    onConnect={onConnect}\r\n                    onElementsRemove={onElementsRemove}\r\n                    onNodeDoubleClick={onElementDoubleClick}\r\n                    onEdgeDoubleClick={onElementDoubleClick}\r\n                    onLoad={onLoad}\r\n                    onDrop={onDrop}\r\n                    onDragOver={onDragOver}\r\n                    onNodeDragStop={onNodeDragStop}\r\n                    preventScrolling={true}\r\n                    style={{\r\n                        width: '94vw',\r\n                        height: '90vh'\r\n                    }}\r\n                >\r\n                    <Controls/>\r\n                </ReactFlow>\r\n            </Grid>\r\n            <Grid item md={2} zIndex={2} height={200} sx={{background: \"white\"}}>\r\n                <Sidebar/>\r\n            </Grid>\r\n        </Grid>\r\n    );\r\n};\r\n\r\nexport default Graph;","import React, {Component} from 'react';\r\nimport {Box, IconButton, Stack, Tooltip} from \"@mui/material\";\r\nimport {ViewModeProps} from \"../StageBuilder.types\";\r\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\r\nimport {styled} from \"@mui/material/styles\";\r\n\r\ntype Props = {\r\n    mode: ViewModeProps,\r\n    allModes: { [mode: string]: { title: string, icon: Component } },\r\n    onChange: (mode: ViewModeProps) => void,\r\n    onBack: () => void\r\n};\r\n\r\nconst GoBackButton = styled(IconButton)(({theme}) => ({\r\n    color: theme.palette.primary.contrastText,\r\n    backgroundColor: theme.palette.primary.main,\r\n    '&:hover': {\r\n        backgroundColor: theme.palette.primary.dark,\r\n    },\r\n}));\r\n\r\nconst Controls = (props: Props) => {\r\n    const {mode, allModes, onChange, onBack} = props;\r\n\r\n    const renderButtons = () => {\r\n        const types = Object.keys(allModes);\r\n        return types.map((type: any) => {\r\n            const fill = mode === type ? \"primary\" : \"default\";\r\n            const title = allModes[type].title;\r\n            const icon = allModes[type].icon;\r\n            return (\r\n                <Box key={type}>\r\n                    <Tooltip title={title}>\r\n                        <IconButton color={fill} onClick={() => onChange(type as ViewModeProps)}>\r\n                            {icon}\r\n                        </IconButton>\r\n                    </Tooltip>\r\n                </Box>\r\n            );\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Box display={\"flex\"} justifyContent={\"flex-end\"} sx={{position: \"sticky\", top: 60}} p={1} zIndex={1}>\r\n            <Box flex={1}>\r\n                <Tooltip title={\"Назад\"}>\r\n                    <GoBackButton onClick={onBack}>\r\n                        {<ArrowBackIcon fontSize={\"large\"}/>}\r\n                    </GoBackButton>\r\n                </Tooltip>\r\n            </Box>\r\n            <Stack direction=\"row\" spacing={1}>\r\n                {renderButtons()}\r\n            </Stack>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default Controls","import React from \"react\";\r\n\r\nimport {WidgetProps} from \"@rjsf/core\";\r\n\r\nconst AudioWidget = ({\r\n                         id,\r\n                         schema,\r\n                         options,\r\n                         value,\r\n                         required,\r\n                         disabled,\r\n                         readonly,\r\n                         label,\r\n                         onChange,\r\n                         onBlur,\r\n                         onFocus,\r\n                     }: WidgetProps) => {\r\n\r\n    const _onChange = ({\r\n                           target: {value},\r\n                       }: React.ChangeEvent<HTMLInputElement>) =>\r\n        onChange(schema.type == \"boolean\" ? value !== \"false\" : value);\r\n    const _onBlur = ({target: {value}}: React.FocusEvent<HTMLInputElement>) =>\r\n        onBlur(id, value);\r\n    const _onFocus = ({\r\n                          target: {value},\r\n                      }: React.FocusEvent<HTMLInputElement>) => onFocus(id, value);\r\n\r\n\r\n    return (\r\n        <p>Здесь будет аудио</p>\r\n    );\r\n};\r\n\r\nexport default AudioWidget;","import React from \"react\";\r\n\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nimport { WidgetProps } from \"@rjsf/core\";\r\n\r\nconst TextWidget = ({\r\n  id,\r\n  placeholder,\r\n  required,\r\n  readonly,\r\n  disabled,\r\n  label,\r\n  value,\r\n  onChange,\r\n  onBlur,\r\n  onFocus,\r\n  autofocus,\r\n  options,\r\n  schema,\r\n  rawErrors = [],\r\n\r\n}: WidgetProps) => {\r\n  const _onChange = ({\r\n    target: { value },\r\n  }: React.ChangeEvent<HTMLInputElement>) =>\r\n    onChange(value === \"\" ? options.emptyValue : value);\r\n  const _onBlur = ({ target: { value } }: React.FocusEvent<HTMLInputElement>) =>\r\n    onBlur(id, value);\r\n  const _onFocus = ({\r\n    target: { value },\r\n  }: React.FocusEvent<HTMLInputElement>) => onFocus(id, value);\r\n  const inputType = (schema.type) === 'string' ?  'text' : `${schema.type}`\r\n    \r\n  return (\r\n    <Form.Group className=\"mb-0\">\r\n      <Form.Label className={rawErrors.length > 0 ? \"text-danger\" : \"\"}>\r\n        {label || schema.title}\r\n        {(label || schema.title) && required ? \"*\" : null}\r\n      </Form.Label>\r\n      <Form.Control\r\n        id={id}\r\n        placeholder={placeholder}\r\n        autoFocus={autofocus}\r\n        required={required}\r\n        disabled={disabled}\r\n        readOnly={readonly}\r\n        className={rawErrors.length > 0 ? \"is-invalid\" : \"\"}\r\n        list={schema.examples ? `examples_${id}` : undefined}\r\n        type={inputType}\r\n        value={value || value === 0 ? value : \"\"}\r\n        onChange={_onChange}\r\n        onBlur={_onBlur}\r\n        onFocus={_onFocus}\r\n\r\n      />\r\n      {schema.examples ? (\r\n        <datalist id={`examples_${id}`}>\r\n          {(schema.examples as string[])\r\n            .concat(schema.default ? ([schema.default] as string[]) : [])\r\n            .map((example: any) => {\r\n              return <option key={example} value={example} />;\r\n            })}\r\n        </datalist>\r\n      ) : null}\r\n    </Form.Group>\r\n  );\r\n};\r\n\r\nexport default TextWidget;","import React from \"react\";\r\n\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nimport {WidgetProps} from \"@rjsf/core\";\r\n\r\nconst CustomLinkWidget = ({required, label, value, schema, rawErrors = []}: WidgetProps) => {\r\n    return (\r\n        value ? <Form.Group className=\"mb-0\">\r\n                <Form.Label className={rawErrors.length > 0 ? \"text-danger\" : \"\"}>\r\n                    {label || schema.title}\r\n                    {(label || schema.title) && required ? \"*\" : null}\r\n                </Form.Label>\r\n                <br/>\r\n                <a href={value}>{value}</a>\r\n            </Form.Group>\r\n            : null\r\n    );\r\n};\r\n\r\nexport default CustomLinkWidget;","import React from \"react\";\r\n\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nimport { WidgetProps } from \"@rjsf/core\";\r\n\r\nconst RadioWidget = ({\r\n  id,\r\n  schema,\r\n  options,\r\n  value,\r\n  required,\r\n  disabled,\r\n  readonly,\r\n  label,\r\n  onChange,\r\n  onBlur,\r\n  onFocus,\r\n}: WidgetProps) => {\r\n  const { enumOptions, enumDisabled } = options;\r\n\r\n  const _onChange = ({\r\n    target: { value },\r\n  }: React.ChangeEvent<HTMLInputElement>) =>\r\n    onChange(schema.type == \"boolean\" ? value !== \"false\" : value);\r\n  const _onBlur = ({ target: { value } }: React.FocusEvent<HTMLInputElement>) =>\r\n    onBlur(id, value);\r\n  const _onFocus = ({\r\n    target: { value },\r\n  }: React.FocusEvent<HTMLInputElement>) => onFocus(id, value);\r\n\r\n  const inline = Boolean(options && options.inline);\r\n\r\n  return (\r\n    <Form.Group className=\"mb-0\">\r\n      <Form.Label className=\"d-block\">\r\n        {label || schema.title}\r\n        {(label || schema.title) && required ? \"*\" : null}\r\n      </Form.Label>\r\n      {(enumOptions as any).map((option: any, i: number) => {\r\n        const itemDisabled =\r\n          Array.isArray(enumDisabled) &&\r\n          enumDisabled.indexOf(option.value) !== -1;\r\n        const checked = option.value == value;\r\n\r\n        const radio = (\r\n          <Form.Check\r\n            inline={inline}\r\n            label={option.label}\r\n            id={`${id}_${option.label}`}\r\n            key={i}\r\n            name={id}\r\n            type=\"radio\"\r\n            disabled={disabled || itemDisabled || readonly}\r\n            checked={checked}\r\n            required={required}\r\n            value={option.value}\r\n            onChange={_onChange}\r\n            onBlur={_onBlur}\r\n            onFocus={_onFocus}\r\n          />\r\n        );\r\n        return radio;\r\n      })}\r\n    </Form.Group>\r\n  );\r\n};\r\n\r\nexport default RadioWidget;","import React from 'react';\r\nimport {AudioWidget, AutoCompleteWidget, LinkWidget, RadioWidget} from \"./custom-widgets\";\r\nimport JsonForm from \"@rjsf/bootstrap-4\";\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\ntype Props = {\r\n    schema: object,\r\n    uiSchema?: object,\r\n    formData?: any,\r\n    onChange?: (formData: object) => void,\r\n    onSubmit?: (formData: object) => void,\r\n    hideButton?: boolean\r\n};\r\n\r\nconst Form = (props: Props) => {\r\n    const {schema, uiSchema, formData, hideButton, onChange, onSubmit} = props;\r\n\r\n    const widgets = {\r\n        customfile: AudioWidget,\r\n        autocomplete: AutoCompleteWidget,\r\n        RadioWidget: RadioWidget,\r\n        customlink: LinkWidget,\r\n        audio: AudioWidget\r\n    };\r\n\r\n    const handleChange = (e: { formData: object }) => {\r\n        console.log(e.formData)\r\n        if (onChange) {\r\n            onChange(e.formData)\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    const handleSubmit = (e: {formData: object}) => {\r\n        console.log(e.formData)\r\n        if (onSubmit) {\r\n            onSubmit(e.formData)\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    return (\r\n        <JsonForm\r\n            schema={schema}\r\n            uiSchema={uiSchema}\r\n            formData={formData}\r\n            widgets={widgets}\r\n            onChange={handleChange}\r\n            onSubmit={handleSubmit}\r\n        >\r\n            {hideButton ? \" \" :\r\n                <button type=\"submit\" className=\"btn btn-primary\">Отправить</button>}\r\n        </JsonForm>\r\n    );\r\n};\r\n\r\nexport default Form","import React from 'react'\r\n// @ts-ignore\r\nimport {Input} from 'reactstrap';\r\n\r\ntype Parameters = {\r\n    name: string,\r\n    path: string,\r\n    definitionData: any,\r\n    definitionUi: any,\r\n    category: string,\r\n    'ui:options': { private: boolean, default: string }\r\n};\r\n\r\nconst CustomAudioField = ({\r\n                             parameters,\r\n                             onChange,\r\n                         }: { parameters: Parameters, onChange: (newParams: Parameters) => void, }) => (\r\n    <div>\r\n        <div style={{display: \"flex\", justifyContent: \"center\", alignItems: \"baseline\", padding: \"0 10px\"}}>\r\n            <h5 style={{padding: \"0 5px\"}}>Private Upload</h5>\r\n            <input\r\n                checked={parameters['ui:options']?.private}\r\n                type=\"checkbox\"\r\n                onChange={(ev: React.ChangeEvent<any>) =>\r\n                    onChange({...parameters, \"ui:options\": {...parameters['ui:options'], private: ev.target.checked}})\r\n                }\r\n                className='card-text'\r\n            />\r\n        </div>\r\n        <h5>Default Audio (Link)</h5>\r\n        <Input\r\n            value={parameters['ui:options']?.default ?? \"\"}\r\n            placeholder='Default'\r\n            type='text'\r\n            onChange={(ev: React.ChangeEvent<any>) =>\r\n                onChange({...parameters, \"ui:options\": {...parameters['ui:options'], default: ev.target.value}})\r\n            }\r\n            className='card-text'\r\n        />\r\n    </div>\r\n);\r\n\r\nconst AudioType = {\r\n    audio: {\r\n        displayName: \"Audio\",\r\n        matchIf: [\r\n            {\r\n                types: [\"string\"],\r\n                widget: \"audio\"\r\n            },\r\n        ],\r\n        possibleOptions: ['private', 'default'],\r\n        defaultDataSchema: {},\r\n        defaultUiSchema: {\r\n            \"ui:widget\": \"audio\",\r\n            \"ui:options\": {private: false, default: \"\"}\r\n        },\r\n        type: \"string\",\r\n        cardBody: CustomAudioField,\r\n        // modalBody: (parameters: any, onChange: any) => <div>\r\n        //     Extra editing options in modal appear hear\r\n        // </div>,\r\n    }\r\n};\r\n\r\nexport default AudioType","import React from 'react'\r\n// @ts-ignore\r\nimport {Input} from 'reactstrap';\r\n\r\ntype Parameters = {\r\n    name: string,\r\n    path: string,\r\n    definitionData: any,\r\n    definitionUi: any,\r\n    category: string,\r\n    'ui:options': { webhook: string, params: string, searchField: string, responseField: string }\r\n};\r\n\r\ntype CustomFieldProps = { parameters: Parameters, onChange: (newParams: Parameters) => void }\r\n\r\nconst CustomAutoCompleteField = ({parameters, onChange}: CustomFieldProps) => (\r\n    <React.Fragment>\r\n        <h5>Webhook</h5>\r\n        <Input\r\n            value={parameters['ui:options']?.webhook}\r\n            placeholder='Webhook'\r\n            type={'text'}\r\n            onChange={(ev: React.ChangeEvent<any>) =>\r\n                onChange({...parameters, \"ui:options\": {...parameters['ui:options'], webhook: ev.target.value}})\r\n            }\r\n            className='card-text'\r\n        />\r\n        <br/>\r\n        <h5>Params</h5>\r\n        <Input\r\n            value={parameters['ui:options']?.params}\r\n            placeholder='Params'\r\n            type={'text'}\r\n            onChange={(ev: React.ChangeEvent<any>) =>\r\n                onChange({...parameters, \"ui:options\": {...parameters['ui:options'], params: ev.target.value}})\r\n            }\r\n            className='card-text'\r\n        />\r\n        <br/>\r\n        <div style={{display: \"flex\", justifyContent: \"center\", alignItems: \"center\"}}>\r\n            <div style={{width: '100%', paddingRight: 7}}>\r\n                <h5>Search Field</h5>\r\n                <Input\r\n                    value={parameters['ui:options']?.searchField}\r\n                    placeholder='Search Field'\r\n                    type={'text'}\r\n                    onChange={(ev: React.ChangeEvent<any>) =>\r\n                        onChange({...parameters, \"ui:options\": {...parameters['ui:options'], searchField: ev.target.value}})\r\n                    }\r\n                    className='card-text'\r\n                />\r\n            </div>\r\n            <div style={{width: '100%', paddingLeft: 7}}>\r\n                <h5>Response Field</h5>\r\n                <Input\r\n                    value={parameters['ui:options']?.responseField}\r\n                    placeholder='Response Field'\r\n                    type={'text'}\r\n                    onChange={(ev: React.ChangeEvent<any>) =>\r\n                        onChange({...parameters, \"ui:options\": {...parameters['ui:options'], responseField: ev.target.value}})\r\n                    }\r\n                    className='card-text'\r\n                />\r\n            </div>\r\n        </div>\r\n    </React.Fragment>\r\n);\r\n\r\n\r\nconst CustomAutoCompleteType = {\r\n    autocomplete: {\r\n        displayName: \"AutoComplete\",\r\n        matchIf: [\r\n            {\r\n                types: [\"string\"],\r\n                widget: \"autocomplete\"\r\n            },\r\n        ],\r\n        possibleOptions: ['webhook', 'params', 'searchField', 'responseField'],\r\n        defaultDataSchema: {},\r\n        defaultUiSchema: {\r\n            \"ui:widget\": \"autocomplete\",\r\n            \"ui:options\": {webhook: '', params: '', searchField: '', responseField: ''}\r\n        },\r\n        type: \"string\",\r\n        cardBody: CustomAutoCompleteField,\r\n        // modalBody: (parameters: any, onChange: any) => <div>\r\n        //     Extra editing options in modal appear hear\r\n        // </div>,\r\n    }\r\n};\r\n\r\nexport default CustomAutoCompleteType","import React from 'react'\r\n\r\ntype Parameters = {\r\n    name: string,\r\n    path: string,\r\n    definitionData: any,\r\n    definitionUi: any,\r\n    category: string,\r\n    'ui:options': { private: boolean, multiple: boolean }\r\n};\r\n\r\nconst CustomFileField = ({\r\n                             parameters,\r\n                             onChange,\r\n                         }: { parameters: Parameters, onChange: (newParams: Parameters) => void, }) => (\r\n    <div style={{display: \"flex\", justifyContent: \"center\", alignItems: \"center\"}}>\r\n        <div style={{display: \"flex\", alignItems: \"baseline\", padding: \"0 10px\"}}>\r\n            <h5 style={{padding: \"0 5px\"}}>Private Upload</h5>\r\n            <input\r\n                checked={parameters['ui:options']?.private}\r\n                type=\"checkbox\"\r\n                onChange={(ev: React.ChangeEvent<any>) =>\r\n                    onChange({...parameters, \"ui:options\": {...parameters['ui:options'], private: ev.target.checked}})\r\n                }\r\n                className='card-text'\r\n            />\r\n        </div>\r\n        <div style={{display: \"flex\", alignItems: \"baseline\", padding: \"0 10px\"}}>\r\n            <h5 style={{padding: \"0 5px\"}}>Multiple Files</h5>\r\n            <input\r\n                checked={parameters['ui:options']?.multiple}\r\n                type=\"checkbox\"\r\n                onChange={(ev: React.ChangeEvent<any>) =>\r\n                    onChange({...parameters, \"ui:options\": {...parameters['ui:options'], multiple: ev.target.checked}})\r\n                }\r\n                className='card-text'\r\n            />\r\n        </div>\r\n    </div>\r\n);\r\n\r\nconst CustomFileType = {\r\n    file: {\r\n        displayName: \"File\",\r\n        matchIf: [\r\n            {\r\n                types: [\"string\"],\r\n                widget: \"customfile\"\r\n            },\r\n        ],\r\n        possibleOptions: ['private', 'multiple'],\r\n        defaultDataSchema: {},\r\n        defaultUiSchema: {\r\n            \"ui:widget\": \"customfile\",\r\n            \"ui:options\": {private: false, multiple: false}\r\n        },\r\n        type: \"string\",\r\n        cardBody: CustomFileField,\r\n        // modalBody: (parameters: any, onChange: any) => <div>\r\n        //     Extra editing options in modal appear hear\r\n        // </div>,\r\n    }\r\n};\r\n\r\nexport default CustomFileType","import React from 'react'\r\n// @ts-ignore\r\nimport {Input} from 'reactstrap';\r\n\r\ntype Parameters = {\r\n    name: string,\r\n    path: string,\r\n    definitionData: any,\r\n    definitionUi: any,\r\n    category: string,\r\n    default: string\r\n};\r\n\r\ntype CustomFieldProps = { parameters: Parameters, onChange: (newParams: Parameters) => void }\r\n\r\nconst CustomLinkField = ({parameters, onChange}: CustomFieldProps) => (\r\n    <React.Fragment>\r\n        <h5>Default value</h5>\r\n        <Input\r\n            value={parameters.default ?? \"\"}\r\n            placeholder='Default'\r\n            type='text'\r\n            onChange={(ev: React.ChangeEvent<any>) =>\r\n                onChange({...parameters, default: ev.target.value})\r\n            }\r\n            className='card-text'\r\n        />\r\n    </React.Fragment>\r\n);\r\n\r\n\r\nconst CustomLinkType = {\r\n    link: {\r\n        displayName: \"Link\",\r\n        matchIf: [\r\n            {\r\n                types: [\"string\"],\r\n                widget: \"customlink\"\r\n            },\r\n        ],\r\n        defaultDataSchema: {},\r\n        defaultUiSchema: {\r\n            \"ui:widget\": \"customlink\"\r\n        },\r\n        type: \"string\",\r\n        cardBody: CustomLinkField\r\n    }\r\n};\r\n\r\nexport default CustomLinkType","import React from 'react';\r\nimport {AudioType, AutoCompleteType, CustomFileType, CustomLinkType} from \"./custom-fields\";\r\n// @ts-ignore\r\nimport {FormBuilder as DefaultFormBuilder} from '@ginkgo-bioworks/react-json-schema-form-builder';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\ntype Props = {\r\n    schema: string,\r\n    uiSchema: string,\r\n    onChange: (schema: string, ui: string) => void\r\n};\r\n\r\nconst FormBuilder = (props: Props) => {\r\n    const {schema, uiSchema, onChange} = props;\r\n\r\n    const customFormInputs = {\r\n        ...CustomFileType,\r\n        ...AutoCompleteType,\r\n        ...CustomLinkType,\r\n        ...AudioType\r\n    }\r\n\r\n    const handleChange = (schema: string, ui: string) => {\r\n        onChange(schema, ui)\r\n    }\r\n\r\n    return (\r\n        <DefaultFormBuilder\r\n            schema={schema}\r\n            uischema={uiSchema}\r\n            onChange={handleChange}\r\n            mods={{customFormInputs}}\r\n        />\r\n    );\r\n};\r\n\r\nexport default FormBuilder","import React from 'react';\r\nimport Box, {BoxProps} from \"@mui/material/Box\";\r\nimport {styled} from \"@mui/material/styles\";\r\n\r\nconst BuilderLayout = styled(Box)<BoxProps>(() => ({\r\n    width: '70%',\r\n    minWidth: '400px',\r\n    margin: '0 auto'\r\n}));\r\n\r\nexport default BuilderLayout","import React from 'react';\r\nimport Form from \"../../../../components/form/Form\"\r\nimport StageOptionsSchema from '../StageOptionsSchema.json'\r\nimport {Box} from \"@mui/material\";\r\nimport FormBuilder from \"../../../../components/form-builder/FormBuilder\";\r\nimport BuilderLayout from \"../../../../components/layout/common-layouts/BuilderLayout\";\r\n\r\ntype Props = {\r\n    schema: string,\r\n    uiSchema: string,\r\n    formData: any,\r\n    onSchemaChange: (schema: string, ui: string) => void,\r\n    onFormDataChange: (formData: any) => void\r\n};\r\n\r\nconst Builder = (props: Props) => {\r\n    const {\r\n        schema,\r\n        uiSchema,\r\n        formData,\r\n        onSchemaChange,\r\n        onFormDataChange\r\n    } = props;\r\n\r\n    const optionsSchema: any = {...StageOptionsSchema};\r\n    const inStages = formData[\"in_stages\"];\r\n    if (inStages) {\r\n        optionsSchema[\"properties\"][\"displayed_prev_stages\"][\"items\"][\"enum\"] = inStages;\r\n        optionsSchema[\"properties\"][\"displayed_prev_stages\"][\"description\"] = \"\";\r\n    } else {\r\n        optionsSchema[\"properties\"][\"displayed_prev_stages\"][\"description\"] = \"Нет доступных вариантов.\";\r\n    }\r\n\r\n\r\n    return (\r\n        <Box p={1}>\r\n                <FormBuilder\r\n                    schema={schema}\r\n                    uiSchema={uiSchema}\r\n                    onChange={onSchemaChange}\r\n                />\r\n            <BuilderLayout>\r\n                <Form\r\n                    schema={optionsSchema}\r\n                    uiSchema={{\r\n                        displayed_prev_stages: {\r\n                            \"ui:widget\": \"checkboxes\"\r\n                        }\r\n                    }}\r\n                    formData={formData}\r\n                    onChange={onFormDataChange}\r\n                    hideButton={true}\r\n                />\r\n            </BuilderLayout>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default Builder","import React from 'react';\r\nimport {Editor} from \"@tinymce/tinymce-react\";\r\n\r\ntype Props = {\r\n    data: string\r\n};\r\n\r\nconst TextViewer = (props: Props) => {\r\n    const {data} = props;\r\n\r\n    return (\r\n        <Editor\r\n            id={\"ViewerTinyMCE\"}\r\n            value={data}\r\n            toolbar={false}\r\n            inline={false}\r\n            disabled={true}\r\n            tinymceScriptSrc={process.env.PUBLIC_URL + '/tinymce/tinymce.min.js'}\r\n            init={{\r\n                plugins: 'autoresize',\r\n                menubar: false,\r\n                image_advtab: true,\r\n                importcss_append: true,\r\n            }}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TextViewer","import React from 'react';\r\nimport {Box} from \"@mui/material\";\r\nimport TextViewer from \"../../../../components/text-editor/TextViewer\";\r\nimport Form from \"../../../../components/form/Form\";\r\nimport BuilderLayout from \"../../../../components/layout/common-layouts/BuilderLayout\";\r\n\r\ntype Props = {\r\n    schema: object,\r\n    uiSchema: object,\r\n    text?: string\r\n};\r\n\r\nconst Preview = (props: Props) => {\r\n    const {schema, uiSchema, text} = props;\r\n    return (\r\n        <BuilderLayout>\r\n            {text && <TextViewer data={text}/>}\r\n            <Box py={1}>\r\n                <Form schema={schema} uiSchema={uiSchema}/>\r\n            </Box>\r\n        </BuilderLayout>\r\n    );\r\n};\r\n\r\nexport default Preview","import React from 'react';\r\nimport {Box, Button, FormControlLabel, FormGroup, Grid, Switch, TextField} from \"@mui/material\";\r\n\r\ntype Props = {\r\n    isEditable: boolean,\r\n    schema: string,\r\n    ui: string,\r\n    onSchemaChange: (schema: string) => void,\r\n    onUiChange: (ui: string) => void,\r\n    onIsEditableChange: () => void,\r\n    onSave: () => void,\r\n    onUndo: () => void,\r\n};\r\n\r\nconst SchemaEditor = (props: Props) => {\r\n    const {isEditable, schema, ui, onSchemaChange, onUiChange, onIsEditableChange, onSave, onUndo} = props;\r\n\r\n    let prettySchema = schema, prettyUi = ui;\r\n    try {\r\n        const parsedSchema = JSON.parse(schema);\r\n        prettySchema = JSON.stringify(parsedSchema, null, 2);\r\n\r\n        const parsedUi = JSON.parse(ui);\r\n        prettyUi = JSON.stringify(parsedUi, null, 2);\r\n    } catch (e) {\r\n        console.log(e)\r\n    }\r\n\r\n    const handleIsEditableChange = () => {\r\n        onIsEditableChange();\r\n    }\r\n\r\n    const handleSchemaChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        onSchemaChange(event.target.value);\r\n    }\r\n\r\n    const handleUiChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        onUiChange(event.target.value);\r\n    }\r\n\r\n    const handleSave = () => {\r\n        onSave();\r\n    }\r\n\r\n    const handleUndo = () => {\r\n        onUndo();\r\n    }\r\n\r\n    return (\r\n        <Box>\r\n            <Grid container alignItems={\"center\"}>\r\n                <FormGroup sx={{my: 1}}>\r\n                    <FormControlLabel\r\n                        control={<Switch\r\n                            checked={isEditable}\r\n                            onChange={handleIsEditableChange}\r\n                            name=\"edit\"\r\n                            inputProps={{'aria-label': 'edit'}}\r\n                        />}\r\n                        labelPlacement=\"start\"\r\n                        label=\"Редактировать\"/>\r\n                </FormGroup>\r\n                {isEditable &&\r\n                    <Button sx={{m: 1}} color={\"primary\"} variant={\"contained\"} onClick={handleSave}>Сохранить\r\n                        изменения</Button>\r\n                }\r\n                {isEditable &&\r\n                    <Button sx={{m: 1}} color={\"primary\"} variant={\"contained\"} onClick={handleUndo}>Отменить\r\n                        изменения</Button>\r\n                }\r\n            </Grid>\r\n            <Grid container>\r\n                <Grid item xs={12} md={6} p={1}>\r\n                    <TextField\r\n                        label=\"Schema\"\r\n                        multiline\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        InputProps={{\r\n                            readOnly: !isEditable,\r\n                        }}\r\n                        value={prettySchema}\r\n                        onChange={handleSchemaChange}\r\n                        style={{marginTop: 15, marginBottom: 15}}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} md={6} p={1}>\r\n                    <TextField\r\n                        label=\"Ui\"\r\n                        multiline\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        InputProps={{\r\n                            readOnly: !isEditable,\r\n                        }}\r\n                        value={prettyUi}\r\n                        onChange={handleUiChange}\r\n                        style={{marginTop: 15, marginBottom: 30}}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default SchemaEditor","import React, {useEffect, useState} from 'react';\r\nimport useAxios from \"../../../../services/api/useAxios\";\r\nimport Form from \"../../../../components/form/Form\";\r\n\r\ntype Props = {\r\n    id: number,\r\n};\r\n\r\nconst Plugin = (props: Props) => {\r\n    const {id} = props;\r\n    const {getTaskStageOptions} = useAxios();\r\n\r\n    const [schema, setSchema] = useState({});\r\n\r\n    const getOptions = async () => {\r\n        const options = await getTaskStageOptions();\r\n        if (options) {\r\n            return options.actions.POST;\r\n        } else {\r\n            return undefined;\r\n        }\r\n    }\r\n\r\n    const transformOptionsToForm = (options: any) => {\r\n        const DEFAULT_FORM_TYPES = [\"string\", \"number\", \"integer\", \"boolean\", \"null\"];\r\n\r\n\r\n        const keys = options ? Object.keys(options) : []\r\n        const properties: any = {}\r\n        const required: any[] = []\r\n\r\n        keys.forEach(key => {\r\n            const {type, label, help_text, required: req} = options[key]\r\n            if (DEFAULT_FORM_TYPES.includes(type)) {\r\n                properties[key] = {\r\n                    type: type,\r\n                    title: label,\r\n                    description: help_text\r\n                }\r\n                if (req) {\r\n                    required.push(key)\r\n                }\r\n            } else if (type === \"decimal\") {\r\n                properties[key] = {\r\n                    type: \"number\",\r\n                    title: label,\r\n                    description: help_text\r\n                }\r\n                if (req) {\r\n                    required.push(key)\r\n                }\r\n            }\r\n        })\r\n\r\n        const template = {\r\n            type: \"object\",\r\n            properties: properties,\r\n            required: required\r\n        }\r\n        console.log(template)\r\n        return template\r\n    }\r\n\r\n    useEffect(() => {\r\n        const getData = async () => {\r\n            const options = await getOptions();\r\n            const schema = transformOptionsToForm(options);\r\n            setSchema(schema)\r\n        }\r\n        if (id) {\r\n            getData();\r\n        }\r\n    }, [id])\r\n\r\n    return (\r\n        <div>\r\n            <Form schema={schema}/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Plugin","import React from 'react';\r\nimport ExpandableCard from \"../../../../components/card/ExpandableCard\";\r\nimport Plugin from \"./Plugin\";\r\nimport {Grid} from \"@mui/material\";\r\nimport BuilderLayout from \"../../../../components/layout/common-layouts/BuilderLayout\";\r\n\r\n\r\ntype Props = {};\r\n\r\nconst Plugins = (props: Props) => {\r\n    const {} = props;\r\n    const pluginsList = [1, 2];\r\n\r\n    return (\r\n        <BuilderLayout>\r\n            <Grid container py={2} spacing={2}>\r\n                {pluginsList.map((p, index) =>\r\n                    <Grid item xs={12} key={index}>\r\n                        <ExpandableCard data={{name: p}} hideOpenButton={true}>\r\n                            <Plugin id={p}/>\r\n                        </ExpandableCard>\r\n                    </Grid>\r\n                )}\r\n            </Grid>\r\n        </BuilderLayout>\r\n    );\r\n};\r\n\r\nexport default Plugins","import React from 'react';\r\nimport {Editor} from \"@tinymce/tinymce-react\";\r\nimport \"./Editor.css\"\r\n\r\ntype Props = {\r\n    data: string,\r\n    onChange: (data: string) => void,\r\n};\r\n\r\nconst TextEditor = (props: Props) => {\r\n    const {data, onChange} = props;\r\n\r\n    const handleChange = (d: string) => {\r\n        onChange(d);\r\n    }\r\n\r\n    return (\r\n        <Editor\r\n            id={\"EditorTinyMCE\"}\r\n            onEditorChange={(newValue, editor) => handleChange(newValue)}\r\n            value={data}\r\n            tinymceScriptSrc={process.env.PUBLIC_URL + '/tinymce/tinymce.min.js'}\r\n            init={{\r\n                plugins: 'autosave save print preview paste importcss searchreplace autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern noneditable help charmap emoticons autoresize',\r\n                menubar: 'file edit view insert format tools table help',\r\n                toolbar: 'undo redo | bold italic underline strikethrough | fontselect fontsizeselect formatselect | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save print | insertfile image media link anchor codesample | ltr rtl',\r\n                toolbar_sticky: true,\r\n                image_advtab: true,\r\n                importcss_append: true,\r\n                image_caption: true,\r\n                noneditable_noneditable_class: 'mceNonEditable',\r\n                toolbar_mode: 'sliding',\r\n                contextmenu: 'link image imagetools table',\r\n                autosave_prefix: 'tinymce-autosave-{path}{query}-',\r\n                content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:14px }'\r\n            }}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TextEditor","import React from 'react';\r\nimport TextEditor from \"../../../../components/text-editor/TextEditor\";\r\nimport BuilderLayout from \"../../../../components/layout/common-layouts/BuilderLayout\";\r\n\r\ntype Props = {\r\n    data: string,\r\n    onChange: (data: string) => void,\r\n};\r\n\r\nconst Text = (props: Props) => {\r\n    const {data, onChange} = props;\r\n    return (\r\n        <BuilderLayout>\r\n            <TextEditor data={data} onChange={onChange}/>\r\n        </BuilderLayout>\r\n    );\r\n};\r\n\r\nexport default Text","import React, {useEffect, useState} from 'react';\r\nimport useAxios from \"../../../services/api/useAxios\";\r\nimport {useNavigate, useParams} from \"react-router-dom\";\r\nimport useHelpers from \"../../../utils/hooks/UseHelpers\";\r\nimport {ViewModeProps} from \"./StageBuilder.types\";\r\nimport Controls from \"./controls/Controls\";\r\nimport Builder from \"./builder/Builder\";\r\nimport {Box, Button} from \"@mui/material\";\r\nimport Preview from \"./preview/Preview\";\r\nimport SchemaEditor from \"./schema-editor/SchemaEditor\";\r\nimport Plugins from \"./plugins/Plugins\";\r\nimport BuilderLayout from \"../../../components/layout/common-layouts/BuilderLayout\";\r\nimport Text from \"./text/Text\";\r\nimport {useToast} from \"../../../context/toast/hooks/useToast\";\r\nimport BuildIcon from \"@mui/icons-material/Build\";\r\nimport EditIcon from \"@mui/icons-material/Edit\";\r\nimport VisibilityIcon from \"@mui/icons-material/Visibility\";\r\nimport CompareArrowsIcon from \"@mui/icons-material/CompareArrows\";\r\nimport ExtensionIcon from '@mui/icons-material/Extension';\r\n\r\n\r\nconst StageBuilder = () => {\r\n    const {stageId} = useParams();\r\n    const navigate = useNavigate();\r\n    const {getTaskStage, saveTaskStage} = useAxios();\r\n    const {parseId} = useHelpers();\r\n    const parsedId = parseId(stageId);\r\n    const {openToast} = useToast();\r\n\r\n    const [schema, setSchema] = useState('');\r\n    const [uiSchema, setUiSchema] = useState('');\r\n    const [formData, setFormData] = useState<any>({});\r\n    const [viewMode, setViewMode] = useState<ViewModeProps>(\"builder\");\r\n    const [textEditorData, setTextEditorData] = useState(\"\");\r\n    const [isEditable, setEditable] = useState(false);\r\n    const [tmpSchema, setTmpSchema] = useState(\"\");\r\n    const [tmpUi, setTmpUi] = useState(\"\");\r\n    const [originalSchema, setOriginalSchema] = useState(\"\");\r\n    const [originalUi, setOriginalUi] = useState(\"\");\r\n\r\n\r\n    const VIEW_MODES: any = {\r\n        builder: {title: \"Конструктор\", icon: <BuildIcon fontSize={\"large\"}/>},\r\n        // plugins: {title: \"Плагины\", icon: <ExtensionIcon fontSize={\"large\"}/>},\r\n        text: {title: \"Текст\", icon: <EditIcon fontSize={\"large\"}/>},\r\n        preview: {title: \"Превью\", icon: <VisibilityIcon fontSize={\"large\"}/>},\r\n        editor: {title: \"Схемы\", icon: <CompareArrowsIcon fontSize={\"large\"}/>},\r\n    }\r\n\r\n    useEffect(() => {\r\n        const getStage = async (parsedId: number) => {\r\n            const stage = await getTaskStage(parsedId);\r\n            const {id, json_schema, ui_schema, rich_text, webhook_address, webhook_params, ...options} = stage;\r\n\r\n            options[\"webhook_address\"] = webhook_address ? webhook_address : undefined;\r\n            options[\"webhook_params\"] = webhook_params ? JSON.stringify(webhook_params) : undefined;\r\n\r\n            setSchema(json_schema);\r\n            setUiSchema(ui_schema);\r\n            setTmpSchema(json_schema);\r\n            setTmpUi(ui_schema);\r\n            setOriginalSchema(json_schema);\r\n            setOriginalUi(ui_schema);\r\n            setFormData(options);\r\n            setTextEditorData(rich_text);\r\n        }\r\n\r\n        if (parsedId) {\r\n            getStage(parsedId);\r\n        }\r\n    }, [parsedId])\r\n\r\n    const saveData = () => {\r\n        const {chain, webhook_params, ...responses} = formData;\r\n        const parsed_webhook_params = webhook_params ? JSON.parse(webhook_params) : null;\r\n\r\n        const data = {\r\n            ...responses,\r\n            json_schema: schema,\r\n            ui_schema: uiSchema,\r\n            rich_text: textEditorData,\r\n            webhook_params: parsed_webhook_params\r\n        }\r\n\r\n        return saveTaskStage(parsedId, data)\r\n    }\r\n\r\n    const handleSubmit = () => {\r\n        saveData().then((res: any) => openToast(\"Данные сохранены\", \"success\"));\r\n    }\r\n\r\n    const handleSchemaChange = (schema: string, ui: string) => {\r\n        setSchema(schema);\r\n        setUiSchema(ui);\r\n        setOriginalSchema(schema);\r\n        setOriginalUi(ui);\r\n        setTmpSchema(schema);\r\n        setTmpUi(ui);\r\n    }\r\n\r\n    const handleFormDataChange = (formData: object) => {\r\n        setFormData(formData);\r\n    }\r\n\r\n    const handleTextChange = (d: string) => {\r\n        setTextEditorData(d);\r\n    }\r\n\r\n    const handleViewModeChange = (mode: ViewModeProps) => {\r\n        setViewMode(mode);\r\n    }\r\n\r\n    const handleIsEditableChange = () => {\r\n        setEditable(!isEditable);\r\n    }\r\n\r\n    const handleTmpSchemaChange = (schema: string) => {\r\n        setTmpSchema(schema);\r\n    }\r\n\r\n    const handleTmpUiChange = (ui: string) => {\r\n        setTmpUi(ui);\r\n    }\r\n\r\n    const handleTmpSave = () => {\r\n        setSchema(tmpSchema);\r\n        setUiSchema(tmpUi);\r\n    }\r\n\r\n    const handleTmpUndo = () => {\r\n        setSchema(originalSchema);\r\n        setUiSchema(originalUi);\r\n        setTmpSchema(originalSchema);\r\n        setTmpUi(originalUi);\r\n    }\r\n\r\n    const renderContent = (mode: ViewModeProps) => {\r\n        switch (mode) {\r\n            case \"builder\":\r\n                return <Builder\r\n                    schema={schema}\r\n                    uiSchema={uiSchema}\r\n                    formData={formData}\r\n                    onSchemaChange={handleSchemaChange}\r\n                    onFormDataChange={handleFormDataChange}\r\n                />;\r\n            case \"plugins\":\r\n                return <Plugins/>;\r\n            case \"text\":\r\n                return <Text data={textEditorData} onChange={handleTextChange}/>;\r\n            case \"preview\":\r\n                return <Preview schema={schemaJson} uiSchema={uiJson} text={textEditorData}/>;\r\n            case \"editor\":\r\n                return <SchemaEditor isEditable={isEditable} schema={tmpSchema} ui={tmpUi}\r\n                                     onSchemaChange={handleTmpSchemaChange} onUiChange={handleTmpUiChange}\r\n                                     onIsEditableChange={handleIsEditableChange} onSave={handleTmpSave}\r\n                                     onUndo={handleTmpUndo}/>\r\n        }\r\n    }\r\n\r\n    const goBack = () => {\r\n        // saveData().then(() => navigate(-1))\r\n        // window.prompt(\"Вы уверены что хотите покинуть страницу?\")\r\n        navigate(-1)\r\n    }\r\n\r\n    const schemaJson = schema ? JSON.parse(schema) : {};\r\n    const uiJson = uiSchema ? JSON.parse(uiSchema) : {};\r\n\r\n    return (\r\n        <Box>\r\n            <Controls allModes={VIEW_MODES} mode={viewMode} onChange={handleViewModeChange} onBack={goBack}/>\r\n            {renderContent(viewMode)}\r\n            <BuilderLayout pb={3}>\r\n                <Button variant={\"contained\"} color={\"warning\"} fullWidth onClick={handleSubmit}>Сохранить</Button>\r\n            </BuilderLayout>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default StageBuilder","import React, {useEffect, useState} from 'react';\r\nimport useAxios from \"../../../services/api/useAxios\";\r\nimport {useParams} from \"react-router-dom\";\r\nimport useHelpers from \"../../../utils/hooks/UseHelpers\";\r\nimport {Box, Checkbox, FormControlLabel} from \"@mui/material\";\r\nimport Form from \"../../../components/form/Form\";\r\nimport BuilderLayout from \"../../../components/layout/common-layouts/BuilderLayout\";\r\nimport {useToast} from \"../../../context/toast/hooks/useToast\";\r\n\r\nconst LogicBuilder = () => {\r\n    const {getConditionalStage, saveConditionalStage, getTaskStage} = useAxios();\r\n    const {stageId} = useParams();\r\n    const {parseId, getFormFields} = useHelpers();\r\n    const parsedId = parseId(stageId);\r\n    const {openToast} = useToast();\r\n\r\n    const [schema, setSchema] = useState({});\r\n    const [formData, setFormData] = useState({});\r\n    const [isPingPong, setPingPong] = useState(false);\r\n    const [connectedStages, setConnectedStages] = useState<any[]>();\r\n    const [ready, setReady] = useState(false)\r\n    const [fields, setFields] = useState<string[]>([]);\r\n\r\n\r\n    useEffect(() => {\r\n        getConditionalStage(parsedId).then(stage => {\r\n            setFormData(stage.conditions)\r\n            setPingPong(stage.pingpong)\r\n        })\r\n    }, [parsedId])\r\n\r\n    useEffect(() => {\r\n        const getStage = (stageId?: number) => {\r\n            if (stageId) {\r\n                const taskStage = getTaskStage(stageId);\r\n                if (taskStage) {\r\n                    return taskStage\r\n                } else {\r\n                    return getConditionalStage(stageId)\r\n                }\r\n            }\r\n            return getConditionalStage(parsedId)\r\n        }\r\n\r\n        const getConnectedStages = (ids: number[]) => {\r\n            return ids.map(async connId => {\r\n                let stage = await getStage(connId)\r\n                return {[connId]: stage}\r\n            })\r\n        }\r\n\r\n        const getData = async () => {\r\n            const currentStage = await getStage();\r\n\r\n            let connectedIds;\r\n            if (isPingPong) {\r\n                connectedIds = currentStage.out_stages;\r\n            } else {\r\n                connectedIds = currentStage.in_stages;\r\n            }\r\n            if (connectedIds) {\r\n                const connStages = await Promise.all(getConnectedStages(connectedIds));\r\n                if (Object.keys(connStages).length > 0) {\r\n                    setConnectedStages(connStages)\r\n                    setReady(true)\r\n                }\r\n            }\r\n        }\r\n\r\n        if (parsedId) {\r\n            getData()\r\n        }\r\n\r\n    }, [parsedId, isPingPong])\r\n\r\n    useEffect(() => {\r\n        const getDependentFields = (dep: any) => {\r\n            let data = null\r\n            if (dep.hasOwnProperty(\"oneOf\")) {\r\n                data = dep.oneOf\r\n            }\r\n            if (dep.hasOwnProperty(\"allOf\")) {\r\n                data = dep.allOf\r\n            }\r\n            if (data) {\r\n                return data.map((nested: any) => {\r\n                    // Create tmp schema for function to work\r\n                    const fictionalSchema = {type: \"object\", ...nested};\r\n                    return getFormFields(fictionalSchema)\r\n                }).flat()\r\n            }\r\n            return []\r\n        }\r\n\r\n        if (connectedStages && connectedStages.length > 0) {\r\n            const allFields = connectedStages.map(stageObject => {\r\n                let stage = Object.values(stageObject)[0] as any;\r\n                let stageSchema = stage.json_schema ? JSON.parse(stage.json_schema) : {};\r\n\r\n                // Get dependencies from stage's schema\r\n                let dependencies = {};\r\n                if (stageSchema && stageSchema.dependencies && Object.keys(stageSchema.dependencies).length > 0) {\r\n                    dependencies = stageSchema.dependencies\r\n                }\r\n\r\n                // Return fields from schema's properties and dependencies\r\n                const dependenciesValues = Object.values(dependencies);\r\n                const formFields = getFormFields(stageSchema);\r\n                let depFields = [];\r\n                if (dependenciesValues.length > 0) {\r\n                    depFields = dependenciesValues.map((dep: any) => getDependentFields(dep)).flat()\r\n                }\r\n                return Array.from(new Set([...formFields, ...depFields]))\r\n            }).flat()\r\n\r\n            setFields(allFields)\r\n        }\r\n    }, [connectedStages])\r\n\r\n    useEffect(() => {\r\n        console.log(\"fields\", fields)\r\n        setSchema({\r\n            items: {\r\n                type: 'object',\r\n                title: 'Logic',\r\n                properties: {\r\n                    field: {\r\n                        enum: fields,\r\n                        title: 'Field',\r\n                        type: 'string'\r\n                    },\r\n                    condition: {\r\n                        enum: [\r\n                            '==',\r\n                            '!=',\r\n                            '>',\r\n                            '<',\r\n                            '>=',\r\n                            '<=',\r\n                            'ARRAY-CONTAINS',\r\n                            'ARRAY-CONTAINS-NOT'\r\n                        ],\r\n                        title: 'Condition',\r\n                        type: 'string'\r\n                    },\r\n                    value: {\r\n                        title: 'Value',\r\n                        type: 'string'\r\n                    }\r\n                },\r\n                dependencies: {},\r\n                required: []\r\n            },\r\n            title: 'Logic Array',\r\n            type: 'array',\r\n            dependencies: {},\r\n            required: []\r\n        })\r\n    }, [fields])\r\n\r\n    const handleSubmit = () => {\r\n        let data = {conditions: formData, pingpong: isPingPong}\r\n\r\n        saveConditionalStage(parsedId, data)\r\n            .then((res: any) => openToast(\"Данные сохранены\", \"success\"));\r\n    }\r\n\r\n    const handleChangePingPong = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        setPingPong(event.target.checked);\r\n    }\r\n\r\n    if (!ready) {\r\n        return <p>No node connection or end_ui detected. Connect to one or check if form has fields.</p>\r\n    }\r\n\r\n    return (\r\n        <BuilderLayout pb={3}>\r\n            <FormControlLabel\r\n                control={<Checkbox checked={isPingPong} onChange={handleChangePingPong} name=\"PingPong\"\r\n                                   color=\"primary\"/>}\r\n                label=\"Ping Pong\"\r\n            />\r\n            <Form\r\n                schema={schema}\r\n                formData={formData}\r\n                onChange={(formData) => setFormData(formData)}\r\n                onSubmit={handleSubmit}/>\r\n        </BuilderLayout>\r\n    );\r\n};\r\n\r\nexport default LogicBuilder","import React from 'react';\r\nimport Form from \"../../../components/form/Form\";\r\nimport schema from './CreateChainSchema.json';\r\nimport ui from './CreateChainSchemaUi.json';\r\nimport BuilderLayout from \"../../../components/layout/common-layouts/BuilderLayout\";\r\nimport useAxios from \"../../../services/api/useAxios\";\r\nimport {useLocation, useNavigate, useParams} from \"react-router-dom\";\r\nimport useHelpers from \"../../../utils/hooks/UseHelpers\";\r\n\r\n\r\nconst CreateChain = () => {\r\n    const {createChain} = useAxios();\r\n    const navigate = useNavigate();\r\n    const location: any = useLocation();\r\n    const {campaignId} = useParams();\r\n    const {parseId} = useHelpers();\r\n\r\n\r\n    const parsedId = parseId(campaignId);\r\n    const from = location?.state?.from?.pathname || \"/\";\r\n\r\n    const handleSubmit = (formData: any) => {\r\n        console.log(formData)\r\n        if (campaignId) {\r\n            createChain({campaign: parsedId, ...formData})\r\n                .then(() => {\r\n                    navigate(from)\r\n                })\r\n        } else {\r\n            alert(\"Error: No campaign id\")\r\n        }\r\n    }\r\n\r\n    return (\r\n        <BuilderLayout py={2}>\r\n            <Form schema={schema} uiSchema={ui} onSubmit={handleSubmit}/>\r\n        </BuilderLayout>\r\n    );\r\n};\r\n\r\nexport default CreateChain","import React from 'react';\r\nimport {HashRouter as Router, Route, Routes} from \"react-router-dom\";\r\nimport AuthProvider from \"./context/authentication/AuthProvider\";\r\nimport RequireAuth from \"./pages/login/RequireAuth\";\r\nimport {ROUTES} from \"./utils/constants/Paths\";\r\nimport Campaigns from \"./pages/campaigns/Campaigns\";\r\nimport Login from \"./pages/login/Login\";\r\nimport Layout from \"./components/layout/Layout\";\r\nimport Chains from \"./pages/chains/Chains\";\r\nimport Graph from \"./pages/graph/Graph\";\r\nimport StageBuilder from \"./pages/form-builders/stage-builder/StageBuilder\";\r\nimport LogicBuilder from \"./pages/form-builders/logic-builder/LogicBuilder\";\r\nimport CreateChain from \"./pages/chains/create-chain/CreateChain\";\r\nimport ToastProvider from \"./context/toast/ToastProvider\";\r\n\r\n\r\nconst App = () => (\r\n    <AuthProvider>\r\n        <ToastProvider>\r\n            <Router>\r\n                <Routes>\r\n                    <Route path=\"/\" element={<RequireAuth><Layout/></RequireAuth>}>\r\n                        <Route path={\"campaign\"}>\r\n                            <Route path=\":campaignId\">\r\n                                <Route path=\"chain\">\r\n                                    <Route path=\":chainId\">\r\n                                        <Route path={\"createstage/:stageId\"} element={<StageBuilder/>}/>\r\n                                        <Route path={\"createlogic/:stageId\"} element={<LogicBuilder/>}/>\r\n                                        <Route index element={<Graph/>}/>\r\n                                    </Route>\r\n                                    <Route path=\"new\" element={<CreateChain/>}/>\r\n                                    <Route index element={<Chains/>}/>\r\n                                </Route>\r\n                            </Route>\r\n                            <Route index element={<Campaigns/>}/>\r\n                        </Route>\r\n                        <Route index element={<Campaigns/>}/>\r\n                    </Route>\r\n                    <Route path={ROUTES.login.path} element={<Login/>}/>\r\n                </Routes>\r\n            </Router>\r\n        </ToastProvider>\r\n    </AuthProvider>\r\n);\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}